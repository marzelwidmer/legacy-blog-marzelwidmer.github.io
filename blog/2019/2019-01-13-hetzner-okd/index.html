<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Install OKD on Hetzner Cloud | c3smonkey's blog</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name <YOUR_DOMAIN> --type <SERVER-TYPE> --image <IMAGE> --ssh-key <YOUR_HETZNER_SSH_KEY> --datacenter <DATACENTER> Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2."><meta name=author content="Marcel Widmer"><link rel=canonical href=https://blog.marcelwidmer.org/blog/2019/2019-01-13-hetzner-okd/><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/main.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/nav.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/plugins/css/pico.min.css><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=apple-touch-icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=mask-icon href=https://blog.marcelwidmer.org/static/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.0"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Install OKD on Hetzner Cloud"><meta name=twitter:description content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name <YOUR_DOMAIN> --type <SERVER-TYPE> --image <IMAGE> --ssh-key <YOUR_HETZNER_SSH_KEY> --datacenter <DATACENTER> Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2."><meta property="og:title" content="Install OKD on Hetzner Cloud"><meta property="og:description" content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name <YOUR_DOMAIN> --type <SERVER-TYPE> --image <IMAGE> --ssh-key <YOUR_HETZNER_SSH_KEY> --datacenter <DATACENTER> Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.marcelwidmer.org/blog/2019/2019-01-13-hetzner-okd/"><meta property="og:image" content="https://blog.marcelwidmer.org/static"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-01-13T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-13T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Install OKD on Hetzner Cloud"><meta name=twitter:description content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name <YOUR_DOMAIN> --type <SERVER-TYPE> --image <IMAGE> --ssh-key <YOUR_HETZNER_SSH_KEY> --datacenter <DATACENTER> Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blog","item":"https://blog.marcelwidmer.org/blog/"},{"@type":"ListItem","position":3,"name":"Install OKD on Hetzner Cloud","item":"https://blog.marcelwidmer.org/blog/2019/2019-01-13-hetzner-okd/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Install OKD on Hetzner Cloud","name":"Install OKD on Hetzner Cloud","description":"Inspiration from Installation of OKD 3.10 from start to finish\nCreate a Hetzner VM with the CLI https://github.com/hetznercloud/cli\nhcloud (Hetzner CLI) Let\u0026rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.\nhcloud server create --name \u0026lt;YOUR_DOMAIN\u0026gt; --type \u0026lt;SERVER-TYPE\u0026gt; --image \u0026lt;IMAGE\u0026gt; --ssh-key \u0026lt;YOUR_HETZNER_SSH_KEY\u0026gt; --datacenter \u0026lt;DATACENTER\u0026gt; Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2.","keywords":["k8s","Hetzner Cloud"],"articleBody":"Inspiration from Installation of OKD 3.10 from start to finish\nCreate a Hetzner VM with the CLI https://github.com/hetznercloud/cli\nhcloud (Hetzner CLI) Let’s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.\nhcloud server create --name --type --image --ssh-key --datacenter Server Type hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2.0 GB 20 GB local 2 cx11-ceph 1 2.0 GB 20 GB network 3 cx21 2 4.0 GB 40 GB local 4 cx21-ceph 2 4.0 GB 40 GB network 5 cx31 2 8.0 GB 80 GB local 6 cx31-ceph 2 8.0 GB 80 GB network 7 cx41 4 16.0 GB 160 GB local 8 cx41-ceph 4 16.0 GB 160 GB network 9 cx51 8 32.0 GB 240 GB local 10 cx51-ceph 8 32.0 GB 240 GB network 11 ccx11 2 8.0 GB 80 GB local 12 ccx21 4 16.0 GB 160 GB local 13 ccx31 8 32.0 GB 240 GB local 14 ccx41 16 64.0 GB 360 GB local 15 ccx51 32 128.0 GB 600 GB local 22 cpx11 2 2.0 GB 40 GB local 23 cpx21 3 4.0 GB 80 GB local 24 cpx31 4 8.0 GB 160 GB local 25 cpx41 8 16.0 GB 240 GB local 26 cpx51 16 32.0 GB 360 GB local Image hcloud image list ID TYPE NAME DESCRIPTION IMAGE SIZE DISK SIZE CREATED 1 system ubuntu-16.04 Ubuntu 16.04 - 5 GB 2 years ago 2 system debian-9 Debian 9 - 5 GB 2 years ago 3 system centos-7 CentOS 7 - 5 GB 2 years ago 168855 system ubuntu-18.04 Ubuntu 18.04 - 5 GB 2 years ago 5924233 system debian-10 Debian 10 - 5 GB 9 months ago 8356453 system centos-8 CentOS 8 - 5 GB 6 months ago 9032843 system fedora-31 Fedora 31 - 5 GB 5 months ago 15512617 system ubuntu-20.04 Ubuntu 20.04 - 5 GB 2 days ago Datacenter hcloud datacenter list ID NAME DESCRIPTION LOCATION 2 nbg1-dc3 Nuremberg 1 DC 3 nbg1 3 hel1-dc2 Helsinki 1 DC 2 hel1 4 fsn1-dc14 Falkenstein 1 DC14 fsn1 Create Server Let’s create a Server cx41 with CentOS centos-7 (because of some issues with centos-8) on a data center in Nuremberg nbg1-dc3. When the Server is we will get a Public IP 116.203.16.100.\nhcloud server create --name keepcalm.ch --type cx41 --image centos-8 --ssh-key ~/.ssh/id_rsa_hetzner.pub --datacenter nbg1-dc3 6s [=====================================] 100.00% Waiting for server 5577861 to have started ... done Server 5577861 created IPv4: 116.203.16.100 Rebuild Server if you have already one and want it just rest and re-install the cluster you can user the following command.\nhcloud server rebuild keepcalm.ch --image centos-7 Delete Server hcloud server delete keepcalm.ch Configure DNS Configure now the following DNS entries in your DNS provider with the IP from Hetzner in my case I have gandi.net.\n@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1585063961 10800 3600 604800 10800 * 420 IN CNAME apps.console @ 1800 IN A 116.203.16.100 apps.console 300 IN A 116.203.16.100 console 300 IN A 116.203.16.100 Install OKD Now you can connect with SSH to your VM\nssh -i ~/.ssh/id_rsa_hetzner root@keepcalm.ch The authenticity of host 'keepcalm.ch (116.203.16.100)' can't be established. ECDSA key fingerprint is SHA256:mc7itrGp4777okbKnKDKPDlQwkMi0e4awyh6cfssNXM. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'keepcalm.ch,116.203.16.100' (ECDSA) to the list of known hosts. Last failed login: Sun Apr 26 12:02:57 CEST 2020 from 51.77.212.235 on ssh:notty There were 3 failed login attempts since the last successful login. [root@keepcalm ~]# Update System and install GIT yum -y update \u0026\u0026 yum -y install git Clone Git Repo git clone https://github.com/marzelwidmer/installcentos.git Update user-custom-exports script Update user-custom-exports.sh script with your domain specific settings.\ncd installcentos \u0026\u0026 vi user-custom-exports.sh #!/bin/bash export DOMAIN=\"keepcalm.ch\" export USERNAME=\"admin\" export PASSWORD=\"password\" export MAIL=\"marzelwidmer@gmail.com\" export SCRIPT_REPO=\"\" export IP=\"\" export DISK=\"\" Load user-custom-exports script Execute the shell script to load the variables\n. user-custom-exports.sh Start install script Now we can execute the installation script and press enter till the question Do you wish to enable HTTPS with Let``s Encrypt There we choose 1) Yes.\nroot@keepcalm installcentos]# ./install-openshift.sh Domain to use: (keepcalm.ch): Username: (admin): Password: (password): OpenShift Version: (3.11): IP: (0): API Port: (8443): Do you wish to enable HTTPS with Let's Encrypt? Warnings: Let's Encrypt only works if the IP is using publicly accessible IP and custom certificates. This feature doesn't work with OpenShift CLI for now. 1) Yes 2) No The following questions we answer with yes.\nComplete! Saving debug log to /var/log/letsencrypt/letsencrypt.log Plugins selected: Authenticator manual, Installer None Starting new HTTPS connection (1): acme-v02.api.letsencrypt.org - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Would you be willing to share your email address with the Electronic Frontier Foundation, a founding partner of the Let's Encrypt project and the non-profit organization that develops Certbot? We'd like to send you email about our work encrypting the web, EFF news, campaigns, and ways to support digital freedom. - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - (Y)es/(N)o: yes Starting new HTTPS connection (1): supporters.eff.org Obtaining a new certificate Performing the following challenges: dns-01 challenge for apps.keepcalm.ch dns-01 challenge for keepcalm.ch dns-01 challenge for keepcalm.ch - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - NOTE: The IP of this machine will be publicly logged as having requested this certificate. If you're running certbot in manual mode on a machine that is not your server, please ensure you're okay with that. Are you OK with your IP being logged? - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - (Y)es/(N)o: yes ⚠️ Important Steps: Be sure you update the DNS TXT records with the prompted values\nThe following values you have to add in you DNS. So let’s open again the DNS Admin console from your provider.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Please deploy a DNS TXT record under the name _acme-challenge.apps.keepcalm.ch with the following value: xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI Before continuing, verify the record is deployed. - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Press Enter to Continue In my case something like so :\nYou can check the DNS with https://dnschecker.org/ Check with host command.\nhost -t txt _acme-challenge.apps.keepcalm.ch _acme-challenge.apps.keepcalm.ch descriptive text \"xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI\" Your DNS will look like this:\n@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1587897751 10800 3600 604800 10800 * 420 IN CNAME apps.console @ 1800 IN A 116.203.16.100 _acme-challenge 300 IN TXT \"H2S720yowtzUBVKq3EbH6W8rmgg7qzF0EEVF_IZOz9c\" _acme-challenge 300 IN TXT \"dpMeonbQDeHkbJopDOuXw1j4NtFHXzEvr8CGutiRX8w\" _acme-challenge.apps 300 IN TXT \"xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI\" apps.console 300 IN A 116.203.16.100 console 300 IN A 116.203.16.100 Before continuing, verify the record is deployed. (This must be set up in addition to the previous challenges; do not remove, replace, or undo the previous challenge tasks yet. Note that you might be asked to create multiple distinct TXT records with the same name. This is permitted by DNS standards.) - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Press Enter to Continue Waiting for verification... Resetting dropped connection: acme-v02.api.letsencrypt.org Cleaning up challenges IMPORTANT NOTES: - Congratulations! Your certificate and chain have been saved at: /etc/letsencrypt/live/keepcalm.ch/fullchain.pem Your key file has been saved at: /etc/letsencrypt/live/keepcalm.ch/privkey.pem Your cert will expire on 2020-07-25. To obtain a new or tweaked version of this certificate in the future, simply run certbot again. To non-interactively renew *all* of your certificates, run \"certbot renew\" - Your account credentials have been saved in your Certbot configuration directory at /etc/letsencrypt. You should make a secure backup of this folder now. This configuration directory will also contain certificates and private keys obtained by Certbot so making regular backups of this folder is ideal. - If you like Certbot, please consider supporting our work by: Donating to ISRG / Let's Encrypt: https://letsencrypt.org/donate Donating to EFF: https://eff.org/donate-le Now you have to wait some minutes till the installation is finished.\ncreated volume 199 persistentvolume/vol200 created created volume 200 ****** * Your console is https://console.keepcalm.ch:8443 * Your username is admin * Your password is password * * Login using: * $ oc login -u admin -p password https://console.keepcalm.ch:8443/ ****** Login successful. You have access to the following projects and can switch between them with 'oc project ': * default kube-public kube-service-catalog kube-system management-infra openshift openshift-console openshift-infra openshift-logging openshift-metrics-server openshift-monitoring openshift-node openshift-sdn openshift-template-service-broker openshift-web-console Using project \"default\". [root@keepcalm installcentos]# After the installation is finish you can on : https://console.keepcalm.ch:8443/console/catalog You have now a OKD instance with Let’s Encrypt.\nRenewal Let’s Encrypt There is a crontab with renew command.\ncrontab -l @weekly certbot renew --pre-hook=\"oc scale --replicas=0 dc router\" --post-hook=\"oc scale --replicas=1 dc router\" Check Certificate certbot certificates Saving debug log to /var/log/letsencrypt/letsencrypt.log - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - Found the following certs: Certificate Name: c3smonkey.ch Serial Number: 4657db8105e7b58c87e5f69ff91a84a4178 Domains: c3smonkey.ch *.apps.c3smonkey.ch *.c3smonkey.ch Expiry Date: 2020-10-22 07:16:07+00:00 (VALID: 89 days) Certificate Path: /etc/letsencrypt/live/c3smonkey.ch/fullchain.pem Private Key Path: /etc/letsencrypt/live/c3smonkey.ch/privkey.pem - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ","wordCount":"1744","inLanguage":"en","datePublished":"2019-01-13T00:00:00Z","dateModified":"2019-01-13T00:00:00Z","author":{"@type":"Person","name":"Marcel Widmer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.marcelwidmer.org/blog/2019/2019-01-13-hetzner-okd/"},"publisher":{"@type":"Organization","name":"c3smonkey's blog","logo":{"@type":"ImageObject","url":"https://blog.marcelwidmer.org/static/favicon.ico"}}}</script></head><body><nav class=desktop><ul><li><a class=logo href=https://blog.marcelwidmer.org accesskey=h title="Welcome to my blog (Alt + h)"><img src=/static/favicon.ico alt="Welcome to my blog" width=35 height=35></img><h3 style=margin-bottom:0><strong><em>c3smonkey&rsquo;s blog</em></strong></h3></a></li><li class=toggle-container><input type=checkbox id=switch>
<label for=switch><i id=darkIcon data-feather=moon></i>
<i id=lightIcon data-feather=sun></i></label></li></ul><ul class=desktop-navigation><li><a href=/blog title=Blog><i data-feather=pen-tool></i>
<span>Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><i data-feather=search></i>
<span>Search</span></a></li><li><a href=/contact title=Contact><i data-feather=mail></i>
<span>Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><i data-feather=github></i>
<span></span></a></li></ul><ul class=mobile-navigation><li><button id=menuOpen onclick=openMobile() aria-label="Menu closed">
<i data-feather=menu></i></button>
<button id=menuClose onclick=openMobile() aria-label="Menu opened">
<i data-feather=x></i></button></li></ul></nav><aside class=sidebar id=mobileNav style=display:none><nav><ul><li><a href=/blog title=Blog><span><i data-feather=pen-tool></i>
Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><span><i data-feather=search></i>
Search</span></a></li><li><a href=/contact title=Contact><span><i data-feather=mail></i>
Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><span><i data-feather=github></i></span></a></li></ul></nav></aside><main><div class=container><hgroup><div><a href=https://blog.marcelwidmer.org>Home</a>&nbsp;»&nbsp;<a href=https://blog.marcelwidmer.org/blog/>Blog</a></div><h1>Install OKD on Hetzner Cloud</h1><time datetime='2019-01-13 00:00:00 +0000 UTC'>January 13, 2019</time>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Marcel Widmer<p></p></hgroup><a href=https://blog.marcelwidmer.org/tags/k8s/><kbd>k8s</kbd></a>
<a href=https://blog.marcelwidmer.org/tags/hetzner-cloud/><kbd>Hetzner Cloud</kbd></a><div class="grid grid-main"><div><article class=toc><div><details open><summary accesskey=c title="(Alt + C)"><span>Table of Contents</span></summary><div><ul><li><a href=#hcloud-hetzner-cli aria-label="hcloud (Hetzner CLI)">hcloud (Hetzner CLI)</a><ul><li><a href=#server-type aria-label="Server Type">Server Type</a></li><li><a href=#image aria-label=Image>Image</a></li><li><a href=#datacenter aria-label=Datacenter>Datacenter</a></li><li><a href=#create-server aria-label="Create Server">Create Server</a><ul><li><a href=#rebuild-server aria-label="Rebuild Server">Rebuild Server</a></li><li><a href=#delete-server aria-label="Delete Server">Delete Server</a></li></ul></li></ul></li><li><a href=#configure-dns aria-label="Configure DNS">Configure DNS</a></li><li><a href=#install-okd aria-label="Install OKD">Install OKD</a><ul><li><a href=#update-system-and-install-git aria-label="Update System and install GIT">Update System and install GIT</a></li><li><a href=#clone-git-repo aria-label="Clone Git Repo">Clone Git Repo</a></li><li><a href=#update-user-custom-exports-script aria-label="Update user-custom-exports script">Update user-custom-exports script</a></li><li><a href=#load-user-custom-exports-script aria-label="Load user-custom-exports script">Load user-custom-exports script</a></li><li><a href=#start-install-script aria-label="Start install script">Start install script</a></li></ul></li><li><a href=#renewal-lets-encrypt aria-label="Renewal Let&amp;rsquo;s Encrypt">Renewal Let&rsquo;s Encrypt</a><ul><li><a href=#check-certificate aria-label="Check Certificate">Check Certificate</a></li></ul></li></ul></div></details></div></article><div class=post><div class=share-buttons></div><p>Inspiration from <a href="https://www.youtube.com/watch?v=ZkFIozGY0IA" target=_blank rel=noopener>Installation of OKD 3.10 from start to finish</a></p><p>Create a <code>Hetzner VM</code> with the CLI <a href=https://github.com/hetznercloud/cli target=_blank rel=noopener>https://github.com/hetznercloud/cli</a></p><h1 id=hcloud-hetzner-cli>hcloud (Hetzner CLI)<a class=anchor aria-hidden=true href=#hcloud-hetzner-cli>#</a></h1><p>Let&rsquo;s check first some <code>hcloud</code> command that we can use later to create a <code>VM</code> with the right size and in the <code>Datacenter</code> we want.</p><p><img src=/static/hetzner/hetzner-preis.png alt=hetzner-preis></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud server create --name &lt;YOUR_DOMAIN&gt; --type &lt;SERVER-TYPE&gt; --image &lt;IMAGE&gt; --ssh-key &lt;YOUR_HETZNER_SSH_KEY&gt; --datacenter &lt;DATACENTER&gt;
</span></span></code></pre></div><h2 id=server-type>Server Type<a class=anchor aria-hidden=true href=#server-type>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud server-type list
</span></span><span style=display:flex><span>ID   NAME        CORES   MEMORY     DISK     STORAGE TYPE
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>    cx11        <span style=color:#ae81ff>1</span>       2.0 GB     <span style=color:#ae81ff>20</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>    cx11-ceph   <span style=color:#ae81ff>1</span>       2.0 GB     <span style=color:#ae81ff>20</span> GB    network
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>    cx21        <span style=color:#ae81ff>2</span>       4.0 GB     <span style=color:#ae81ff>40</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>    cx21-ceph   <span style=color:#ae81ff>2</span>       4.0 GB     <span style=color:#ae81ff>40</span> GB    network
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>    cx31        <span style=color:#ae81ff>2</span>       8.0 GB     <span style=color:#ae81ff>80</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>    cx31-ceph   <span style=color:#ae81ff>2</span>       8.0 GB     <span style=color:#ae81ff>80</span> GB    network
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>    cx41        <span style=color:#ae81ff>4</span>       16.0 GB    <span style=color:#ae81ff>160</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>    cx41-ceph   <span style=color:#ae81ff>4</span>       16.0 GB    <span style=color:#ae81ff>160</span> GB   network
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>    cx51        <span style=color:#ae81ff>8</span>       32.0 GB    <span style=color:#ae81ff>240</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>10</span>   cx51-ceph   <span style=color:#ae81ff>8</span>       32.0 GB    <span style=color:#ae81ff>240</span> GB   network
</span></span><span style=display:flex><span><span style=color:#ae81ff>11</span>   ccx11       <span style=color:#ae81ff>2</span>       8.0 GB     <span style=color:#ae81ff>80</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>12</span>   ccx21       <span style=color:#ae81ff>4</span>       16.0 GB    <span style=color:#ae81ff>160</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>13</span>   ccx31       <span style=color:#ae81ff>8</span>       32.0 GB    <span style=color:#ae81ff>240</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>14</span>   ccx41       <span style=color:#ae81ff>16</span>      64.0 GB    <span style=color:#ae81ff>360</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>15</span>   ccx51       <span style=color:#ae81ff>32</span>      128.0 GB   <span style=color:#ae81ff>600</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>22</span>   cpx11       <span style=color:#ae81ff>2</span>       2.0 GB     <span style=color:#ae81ff>40</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>23</span>   cpx21       <span style=color:#ae81ff>3</span>       4.0 GB     <span style=color:#ae81ff>80</span> GB    local
</span></span><span style=display:flex><span><span style=color:#ae81ff>24</span>   cpx31       <span style=color:#ae81ff>4</span>       8.0 GB     <span style=color:#ae81ff>160</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>25</span>   cpx41       <span style=color:#ae81ff>8</span>       16.0 GB    <span style=color:#ae81ff>240</span> GB   local
</span></span><span style=display:flex><span><span style=color:#ae81ff>26</span>   cpx51       <span style=color:#ae81ff>16</span>      32.0 GB    <span style=color:#ae81ff>360</span> GB   local
</span></span></code></pre></div><h2 id=image>Image<a class=anchor aria-hidden=true href=#image>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud image list
</span></span><span style=display:flex><span>ID         TYPE     NAME           DESCRIPTION    IMAGE SIZE   DISK SIZE   CREATED
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>          system   ubuntu-16.04   Ubuntu 16.04   -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>2</span> years ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>          system   debian-9       Debian <span style=color:#ae81ff>9</span>       -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>2</span> years ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>          system   centos-7       CentOS <span style=color:#ae81ff>7</span>       -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>2</span> years ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>168855</span>     system   ubuntu-18.04   Ubuntu 18.04   -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>2</span> years ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>5924233</span>    system   debian-10      Debian <span style=color:#ae81ff>10</span>      -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>9</span> months ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>8356453</span>    system   centos-8       CentOS <span style=color:#ae81ff>8</span>       -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>6</span> months ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>9032843</span>    system   fedora-31      Fedora <span style=color:#ae81ff>31</span>      -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>5</span> months ago
</span></span><span style=display:flex><span><span style=color:#ae81ff>15512617</span>   system   ubuntu-20.04   Ubuntu 20.04   -            <span style=color:#ae81ff>5</span> GB        <span style=color:#ae81ff>2</span> days ago
</span></span></code></pre></div><h2 id=datacenter>Datacenter<a class=anchor aria-hidden=true href=#datacenter>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud datacenter list
</span></span><span style=display:flex><span>ID   NAME        DESCRIPTION          LOCATION
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>    nbg1-dc3    Nuremberg <span style=color:#ae81ff>1</span> DC <span style=color:#ae81ff>3</span>     nbg1
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>    hel1-dc2    Helsinki <span style=color:#ae81ff>1</span> DC <span style=color:#ae81ff>2</span>      hel1
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>    fsn1-dc14   Falkenstein <span style=color:#ae81ff>1</span> DC14   fsn1
</span></span></code></pre></div><h2 id=create-server>Create Server<a class=anchor aria-hidden=true href=#create-server>#</a></h2><p>Let&rsquo;s create a Server <code>cx41</code> with CentOS <code>centos-7</code> (because of some issues with <code>centos-8</code>) on a data center in Nuremberg <code>nbg1-dc3</code>.
When the Server is we will get a Public IP <code>116.203.16.100</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud server create --name keepcalm.ch --type cx41 --image centos-8 --ssh-key ~/.ssh/id_rsa_hetzner.pub --datacenter nbg1-dc3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>6s <span style=color:#f92672>[=====================================]</span> 100.00%
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> server <span style=color:#ae81ff>5577861</span> to have started
</span></span><span style=display:flex><span> ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Server <span style=color:#ae81ff>5577861</span> created
</span></span><span style=display:flex><span>IPv4: 116.203.16.100
</span></span></code></pre></div><h3 id=rebuild-server>Rebuild Server<a class=anchor aria-hidden=true href=#rebuild-server>#</a></h3><p>if you have already one and want it just rest and re-install the cluster you can user the following command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud server rebuild keepcalm.ch --image centos-7
</span></span></code></pre></div><h3 id=delete-server>Delete Server<a class=anchor aria-hidden=true href=#delete-server>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hcloud server delete keepcalm.ch
</span></span></code></pre></div><h1 id=configure-dns>Configure DNS<a class=anchor aria-hidden=true href=#configure-dns>#</a></h1><p>Configure now the following <code>DNS</code> entries in your <code>DNS</code> provider with the <code>IP</code> from <code>Hetzner</code> in my case I have <a href=https://www.gandi.net/en target=_blank rel=noopener>gandi.net</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1585063961 10800 3600 604800 10800
</span></span><span style=display:flex><span>* 420 IN CNAME apps.console
</span></span><span style=display:flex><span>@ 1800 IN A 116.203.16.100
</span></span><span style=display:flex><span>apps.console 300 IN A 116.203.16.100
</span></span><span style=display:flex><span>console 300 IN A 116.203.16.100
</span></span></code></pre></div><h1 id=install-okd>Install OKD<a class=anchor aria-hidden=true href=#install-okd>#</a></h1><p>Now you can connect with <code>SSH</code> to your <code>VM</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i ~/.ssh/id_rsa_hetzner root@keepcalm.ch
</span></span><span style=display:flex><span>The authenticity of host <span style=color:#e6db74>&#39;keepcalm.ch (116.203.16.100)&#39;</span> can<span style=color:#e6db74>&#39;t be established.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ECDSA key fingerprint is SHA256:mc7itrGp4777okbKnKDKPDlQwkMi0e4awyh6cfssNXM.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Warning: Permanently added &#39;</span>keepcalm.ch,116.203.16.100<span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span> to the list of known hosts.
</span></span><span style=display:flex><span>Last failed login: Sun Apr <span style=color:#ae81ff>26</span> 12:02:57 CEST <span style=color:#ae81ff>2020</span> from 51.77.212.235 on ssh:notty
</span></span><span style=display:flex><span>There were <span style=color:#ae81ff>3</span> failed login attempts since the last successful login.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@keepcalm ~<span style=color:#f92672>]</span><span style=color:#75715e>#</span>
</span></span></code></pre></div><h2 id=update-system-and-install-git>Update System and install GIT<a class=anchor aria-hidden=true href=#update-system-and-install-git>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum -y update <span style=color:#f92672>&amp;&amp;</span> yum -y install git
</span></span></code></pre></div><h2 id=clone-git-repo>Clone Git Repo<a class=anchor aria-hidden=true href=#clone-git-repo>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/marzelwidmer/installcentos.git
</span></span></code></pre></div><h2 id=update-user-custom-exports-script>Update user-custom-exports script<a class=anchor aria-hidden=true href=#update-user-custom-exports-script>#</a></h2><p>Update <code>user-custom-exports.sh</code> script with your domain specific settings.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd installcentos <span style=color:#f92672>&amp;&amp;</span> vi user-custom-exports.sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>#!/bin/bash
</span></span><span style=display:flex><span>export DOMAIN=&#34;keepcalm.ch&#34;
</span></span><span style=display:flex><span>export USERNAME=&#34;admin&#34;
</span></span><span style=display:flex><span>export PASSWORD=&#34;password&#34;
</span></span><span style=display:flex><span>export MAIL=&#34;marzelwidmer@gmail.com&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export SCRIPT_REPO=&#34;&#34;
</span></span><span style=display:flex><span>export IP=&#34;&#34;
</span></span><span style=display:flex><span>export DISK=&#34;&#34;
</span></span></code></pre></div><h2 id=load-user-custom-exports-script>Load user-custom-exports script<a class=anchor aria-hidden=true href=#load-user-custom-exports-script>#</a></h2><p>Execute the shell script to load the variables</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>. user-custom-exports.sh
</span></span></code></pre></div><h2 id=start-install-script>Start install script<a class=anchor aria-hidden=true href=#start-install-script>#</a></h2><p>Now we can execute the installation script and press enter till the question <code>Do you wish to enable HTTPS with Let``s Encrypt</code>
There we choose <code>1) Yes</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@keepcalm installcentos<span style=color:#f92672>]</span><span style=color:#75715e># ./install-openshift.sh</span>
</span></span><span style=display:flex><span>Domain to use: <span style=color:#f92672>(</span>keepcalm.ch<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>Username: <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>Password: <span style=color:#f92672>(</span>password<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>OpenShift Version: <span style=color:#f92672>(</span>3.11<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>IP: <span style=color:#f92672>(</span>0<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>API Port: <span style=color:#f92672>(</span>8443<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>Do you wish to enable HTTPS with Let<span style=color:#e6db74>&#39;s Encrypt?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Warnings:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  Let&#39;</span>s Encrypt only works <span style=color:#66d9ef>if</span> the IP is using publicly accessible IP and custom certificates.
</span></span><span style=display:flex><span>  This feature doesn<span style=color:#960050;background-color:#1e0010>&#39;</span>t work with OpenShift CLI <span style=color:#66d9ef>for</span> now.
</span></span><span style=display:flex><span>1<span style=color:#f92672>)</span> Yes
</span></span><span style=display:flex><span>2<span style=color:#f92672>)</span> No
</span></span></code></pre></div><p>The following questions we answer with yes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Complete!
</span></span><span style=display:flex><span>Saving debug log to /var/log/letsencrypt/letsencrypt.log
</span></span><span style=display:flex><span>Plugins selected: Authenticator manual, Installer None
</span></span><span style=display:flex><span>Starting new HTTPS connection <span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>: acme-v02.api.letsencrypt.org
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>Would you be willing to share your email address with the Electronic Frontier
</span></span><span style=display:flex><span>Foundation, a founding partner of the Let<span style=color:#e6db74>&#39;s Encrypt project and the non-profit
</span></span></span><span style=display:flex><span><span style=color:#e6db74>organization that develops Certbot? We&#39;</span>d like to send you email about our work
</span></span><span style=display:flex><span>encrypting the web, EFF news, campaigns, and ways to support digital freedom.
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Y<span style=color:#f92672>)</span>es/<span style=color:#f92672>(</span>N<span style=color:#f92672>)</span>o: yes
</span></span><span style=display:flex><span>Starting new HTTPS connection <span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>: supporters.eff.org
</span></span><span style=display:flex><span>Obtaining a new certificate
</span></span><span style=display:flex><span>Performing the following challenges:
</span></span><span style=display:flex><span>dns-01 challenge <span style=color:#66d9ef>for</span> apps.keepcalm.ch
</span></span><span style=display:flex><span>dns-01 challenge <span style=color:#66d9ef>for</span> keepcalm.ch
</span></span><span style=display:flex><span>dns-01 challenge <span style=color:#66d9ef>for</span> keepcalm.ch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>NOTE: The IP of this machine will be publicly logged as having requested this
</span></span><span style=display:flex><span>certificate. If you<span style=color:#e6db74>&#39;re running certbot in manual mode on a machine that is not
</span></span></span><span style=display:flex><span><span style=color:#e6db74>your server, please ensure you&#39;</span>re okay with that.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Are you OK with your IP being logged?
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Y<span style=color:#f92672>)</span>es/<span style=color:#f92672>(</span>N<span style=color:#f92672>)</span>o: yes
</span></span></code></pre></div><blockquote><p>⚠️ <strong>Important Steps</strong>: Be sure you update the <code>DNS TXT</code> records with the prompted values</p></blockquote><p>The following values you have to add in you <code>DNS</code>.
So let&rsquo;s open again the <code>DNS</code> Admin console from your provider.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>Please deploy a DNS TXT record under the name
</span></span><span style=display:flex><span>_acme-challenge.apps.keepcalm.ch with the following value:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Before continuing, verify the record is deployed.
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>Press Enter to Continue
</span></span></code></pre></div><p>In my case something like so :</p><p><img src=/static/hetzner/acme.png alt=acme></p><p>You can check the <code>DNS</code> with <a href=https://dnschecker.org/#TXT/_acme-challenge.apps.keepcalm.ch target=_blank rel=noopener>https://dnschecker.org/</a>
Check with <code>host</code> command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>host -t txt _acme-challenge.apps.keepcalm.ch
</span></span><span style=display:flex><span>_acme-challenge.apps.keepcalm.ch descriptive text <span style=color:#e6db74>&#34;xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI&#34;</span>
</span></span></code></pre></div><p>Your <code>DNS</code> will look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1587897751 10800 3600 604800 10800
</span></span><span style=display:flex><span>* 420 IN CNAME apps.console
</span></span><span style=display:flex><span>@ 1800 IN A 116.203.16.100
</span></span><span style=display:flex><span>_acme-challenge 300 IN TXT &#34;H2S720yowtzUBVKq3EbH6W8rmgg7qzF0EEVF_IZOz9c&#34;
</span></span><span style=display:flex><span>_acme-challenge 300 IN TXT &#34;dpMeonbQDeHkbJopDOuXw1j4NtFHXzEvr8CGutiRX8w&#34;
</span></span><span style=display:flex><span>_acme-challenge.apps 300 IN TXT &#34;xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI&#34;
</span></span><span style=display:flex><span>apps.console 300 IN A 116.203.16.100
</span></span><span style=display:flex><span>console 300 IN A 116.203.16.100
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Before continuing, verify the record is deployed.
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>This must be set up in addition to the previous challenges; <span style=color:#66d9ef>do</span> not remove,
</span></span><span style=display:flex><span>replace, or undo the previous challenge tasks yet. Note that you might be
</span></span><span style=display:flex><span>asked to create multiple distinct TXT records with the same name. This is
</span></span><span style=display:flex><span>permitted by DNS standards.<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>Press Enter to Continue
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> verification...
</span></span><span style=display:flex><span>Resetting dropped connection: acme-v02.api.letsencrypt.org
</span></span><span style=display:flex><span>Cleaning up challenges
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IMPORTANT NOTES:
</span></span><span style=display:flex><span> - Congratulations! Your certificate and chain have been saved at:
</span></span><span style=display:flex><span>   /etc/letsencrypt/live/keepcalm.ch/fullchain.pem
</span></span><span style=display:flex><span>   Your key file has been saved at:
</span></span><span style=display:flex><span>   /etc/letsencrypt/live/keepcalm.ch/privkey.pem
</span></span><span style=display:flex><span>   Your cert will expire on 2020-07-25. To obtain a new or tweaked
</span></span><span style=display:flex><span>   version of this certificate in the future, simply run certbot
</span></span><span style=display:flex><span>   again. To non-interactively renew *all* of your certificates, run
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;certbot renew&#34;</span>
</span></span><span style=display:flex><span> - Your account credentials have been saved in your Certbot
</span></span><span style=display:flex><span>   configuration directory at /etc/letsencrypt. You should make a
</span></span><span style=display:flex><span>   secure backup of this folder now. This configuration directory will
</span></span><span style=display:flex><span>   also contain certificates and private keys obtained by Certbot so
</span></span><span style=display:flex><span>   making regular backups of this folder is ideal.
</span></span><span style=display:flex><span> - If you like Certbot, please consider supporting our work by:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Donating to ISRG / Let<span style=color:#960050;background-color:#1e0010>&#39;</span>s Encrypt:   https://letsencrypt.org/donate
</span></span><span style=display:flex><span>   Donating to EFF:                    https://eff.org/donate-le
</span></span></code></pre></div><p>Now you have to wait some minutes till the installation is finished.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>created volume <span style=color:#ae81ff>199</span>
</span></span><span style=display:flex><span>persistentvolume/vol200 created
</span></span><span style=display:flex><span>created volume <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>******
</span></span><span style=display:flex><span>* Your console is https://console.keepcalm.ch:8443
</span></span><span style=display:flex><span>* Your username is admin
</span></span><span style=display:flex><span>* Your password is password
</span></span><span style=display:flex><span>*
</span></span><span style=display:flex><span>* Login using:
</span></span><span style=display:flex><span>*
</span></span><span style=display:flex><span>$ oc login -u admin -p password https://console.keepcalm.ch:8443/
</span></span><span style=display:flex><span>******
</span></span><span style=display:flex><span>Login successful.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You have access to the following projects and can switch between them with <span style=color:#e6db74>&#39;oc project &lt;projectname&gt;&#39;</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  * default
</span></span><span style=display:flex><span>    kube-public
</span></span><span style=display:flex><span>    kube-service-catalog
</span></span><span style=display:flex><span>    kube-system
</span></span><span style=display:flex><span>    management-infra
</span></span><span style=display:flex><span>    openshift
</span></span><span style=display:flex><span>    openshift-console
</span></span><span style=display:flex><span>    openshift-infra
</span></span><span style=display:flex><span>    openshift-logging
</span></span><span style=display:flex><span>    openshift-metrics-server
</span></span><span style=display:flex><span>    openshift-monitoring
</span></span><span style=display:flex><span>    openshift-node
</span></span><span style=display:flex><span>    openshift-sdn
</span></span><span style=display:flex><span>    openshift-template-service-broker
</span></span><span style=display:flex><span>    openshift-web-console
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Using project <span style=color:#e6db74>&#34;default&#34;</span>.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@keepcalm installcentos<span style=color:#f92672>]</span><span style=color:#75715e>#</span>
</span></span></code></pre></div><p>After the installation is finish you can on : <a href=https://console.keepcalm.ch:8443/console/catalog target=_blank rel=noopener>https://console.keepcalm.ch:8443/console/catalog</a>
You have now a <code>OKD</code> instance with Let&rsquo;s Encrypt.</p><p><img src=/static/hetzner//console.png alt=hetzner-preis></p><h1 id=renewal-lets-encrypt>Renewal Let&rsquo;s Encrypt<a class=anchor aria-hidden=true href=#renewal-lets-encrypt>#</a></h1><p>There is a <code>crontab</code> with renew command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>crontab -l
</span></span><span style=display:flex><span>@weekly  certbot renew --pre-hook<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;oc scale --replicas=0 dc router&#34;</span> --post-hook<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;oc scale --replicas=1 dc router&#34;</span>
</span></span></code></pre></div><h2 id=check-certificate>Check Certificate<a class=anchor aria-hidden=true href=#check-certificate>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>certbot certificates
</span></span><span style=display:flex><span>Saving debug log to /var/log/letsencrypt/letsencrypt.log
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style=display:flex><span>Found the following certs:
</span></span><span style=display:flex><span>  Certificate Name: c3smonkey.ch
</span></span><span style=display:flex><span>    Serial Number: 4657db8105e7b58c87e5f69ff91a84a4178
</span></span><span style=display:flex><span>    Domains: c3smonkey.ch *.apps.c3smonkey.ch *.c3smonkey.ch
</span></span><span style=display:flex><span>    Expiry Date: 2020-10-22 07:16:07+00:00 <span style=color:#f92672>(</span>VALID: <span style=color:#ae81ff>89</span> days<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    Certificate Path: /etc/letsencrypt/live/c3smonkey.ch/fullchain.pem
</span></span><span style=display:flex><span>    Private Key Path: /etc/letsencrypt/live/c3smonkey.ch/privkey.pem
</span></span><span style=display:flex><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span></code></pre></div></div><div class=share-buttons></div></div><aside><article><h3>See Also</h3><a href=/blog/2019/2019-08-20-certbot-letsencrypt/><hgroup><h4><i>Certbot Let`s Encrypt</i></h4><p><time datetime='2019-01-13 00:00:00 +0000 UTC'>January 13, 2019</time>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a></article></aside></div></div></main><footer class=text-center><span>&copy; 2022 <a href=https://blog.marcelwidmer.org>c3smonkey's blog</a></span><div><a href=https://blog.marcelwidmer.org/legal/privacy>Privacy Policy</a>
<span>&</span>
<a href=https://blog.marcelwidmer.org/legal/terms-and-conditions>Terms and Conditions</a></div></footer><article class=hidden id=cookie-banner><div><span></span></div><footer><a role=button id=consent-cookies>Close</a>
<a role=button class=secondary href=/></a></footer></article><script async src=https://blog.marcelwidmer.org/js/cookie.min.js layout=container></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("kbd");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://blog.marcelwidmer.org/plugins/js/feather.min.js layout=container></script>
<script src=https://blog.marcelwidmer.org/js/script.min.js layout=container></script></body></html>