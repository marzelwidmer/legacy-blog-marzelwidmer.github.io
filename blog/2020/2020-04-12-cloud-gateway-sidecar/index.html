<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Spring Cloud Gateway | c3smonkey's blog</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.
Let&rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.
We start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository
@Document data class Customer(@Id val id: String = UUID."><meta name=author content="Marcel Widmer"><link rel=canonical href=https://blog.marcelwidmer.org/blog/2020/2020-04-12-cloud-gateway-sidecar/><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/main.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/nav.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/plugins/css/pico.min.css><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=apple-touch-icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=mask-icon href=https://blog.marcelwidmer.org/static/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.0"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Spring Cloud Gateway"><meta name=twitter:description content="This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.
Let&rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.
We start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository
@Document data class Customer(@Id val id: String = UUID."><meta property="og:title" content="Spring Cloud Gateway"><meta property="og:description" content="This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.
Let&rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.
We start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository
@Document data class Customer(@Id val id: String = UUID."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.marcelwidmer.org/blog/2020/2020-04-12-cloud-gateway-sidecar/"><meta property="og:image" content="https://blog.marcelwidmer.org/static"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-04-16T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-16T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Spring Cloud Gateway"><meta name=twitter:description content="This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.
Let&rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.
We start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository
@Document data class Customer(@Id val id: String = UUID."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blog","item":"https://blog.marcelwidmer.org/blog/"},{"@type":"ListItem","position":3,"name":"Spring Cloud Gateway","item":"https://blog.marcelwidmer.org/blog/2020/2020-04-12-cloud-gateway-sidecar/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring Cloud Gateway","name":"Spring Cloud Gateway","description":"This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.\nLet\u0026rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.\nWe start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository\n@Document data class Customer(@Id val id: String = UUID.","keywords":["Spring Boot"],"articleBody":"This sample show how easy you can put on an existing API the Spring Cloud Gateway as kind of SideCar where you can manage your Security, Logging etc. Or just provide an other Endpoint URL like in this sample.\nLet’s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.\nWe start with the MongoDB document class Customer and a ReactiveCrudRepository interface CustomerRepository\n@Document data class Customer(@Id val id: String = UUID.randomUUID().toString(), val name: String) interface CustomerRepository : ReactiveCrudRepository Now let’s also create a service class CustomerService for it where we provide the following functionality.\nsave findAll deleteAll findById @Service class CustomerService(private val customerRepository: CustomerRepository) { fun save(customer: Customer) = customerRepository.save(customer) fun findAll() = customerRepository.findAll() fun deleteAll() = customerRepository.deleteAll() fun findById(id: String) = customerRepository.findById(id) } That we have some data we create a little functionality on application start with the ApplicationRunner from Spring Boot.\nLet’s create a Bean definition for the ApplicationRunner that delete first all entries and then save some sample values to it.\nfun main(args: Array) { runApplication(*args) { addInitializers( beans { bean { ApplicationRunner { val customerService = ref() customerService // first cleanUp Database .deleteAll() // create a list of Customers .thenMany( listOf(\"John\", \"Jane\", \"Jack\") .toFlux() .map { Customer(name = it) }) // Save it to the Database .flatMap { customerService.save(it) } // Search all entries .thenMany(customerService.findAll()) // subscribe - let`s do the work... .subscribe { log.info(\"--\u003e $it\") } } } } ) } } Now we have some data in our MongoDB I think now is time to create a other Bean with the Kotlin DSL that provide a Rest endpoint. For this we create an Router that will provide the following endpoints.\n/customers /customers/{id} // Rest API bean { router { val customerService = ref() GET(\"/customers\") { ok().body(customerService.findAll()) } GET(\"/customers/{id}\") { ok().body(customerService.findById(it.pathVariable(\"id\"))) } } } When we start now our application we can call the endpoint and hopefully we get a result like below.\nmvn spring-boot:run http :8080/customers HTTP/1.1 200 OK Content-Type: application/json transfer-encoding: chunked [ { \"id\": \"a16c9582-0f40-4a7b-a566-372a56c3d5c8\", \"name\": \"John\" }, { \"id\": \"944c3752-55c5-4ede-bc09-e02a5e47b390\", \"name\": \"Jane\" }, { \"id\": \"478ce3f9-0eff-4018-a056-0656cd2c5ad4\", \"name\": \"Jack\" } ] Now let’s create a sidecar with Spring cloud Gateway that provide another Rest API /api/customers and /api/customers/{id} Let’s create an additional response header X-AnotherHeader with the value SideCar as well.\n// Gateway Sidecar API // http -v :8080/api/customers // Gateway - Sidecar bean { ref() .routes { // http -v :8080/api/customers route(\"sidecar-api\") { path(\"/api/**\") filters { rewritePath(\"api(?/?.*)\", \"/$\\\\{segment}\") } uri(\"http://localhost:8080\") } } } When we call now the EndPoint /api/customers we expect that we get the result from before and the additional ResponsHeader with X-AnotherHeader: SideCar\nhttp -v :8080/api/customers GET /api/customers HTTP/1.1 Accept: */* Accept-Encoding: gzip, deflate Connection: keep-alive Host: localhost:8080 User-Agent: HTTPie/2.0.0 HTTP/1.1 200 OK Content-Type: application/json X-AnotherHeader: SideCar transfer-encoding: chunked [ { \"id\": \"a36f75ae-a97f-41ba-9b38-59a5a6d38055\", \"name\": \"John\" }, { \"id\": \"c0b25559-13ad-4b6b-ae25-adbcd898db82\", \"name\": \"Jane\" }, { \"id\": \"2a3a1350-4bea-4504-b732-5b7c97602ebb\", \"name\": \"Jack\" } ] With the Kotlin DSL Route definition is it also easy to create routes only for specifics Spring profiles.\nThe following command will start the application with the default profile.\nmvn spring-boot:run Spring Cloud Gateway provide with the Actuator library an endpoint to check the configured routes. Also let’s check first our Routing Table whe we start the application with the default Spring Profile.\nhttp :8080/actuator/gateway/routes HTTP/1.1 200 OK Content-Type: application/json transfer-encoding: chunked [ { \"filters\": [ \"[[RewritePath api(?/?.*) = '/${segment}'], order = 0]\" ], \"order\": 0, \"predicate\": \"Paths: [/api/**], match trailing slash: true\", \"route_id\": \"sidecar-api\", \"uri\": \"http://localhost:8080\" } ] Now create a Route just for a specific Spring Profile foo\nrunApplication(*args) { addInitializers( beans { // Profile profile(\"foo\") { // Gateway - Sidecar bean { ref() .routes { // http -v :8080/ route(\"sidecar-root-to-customers-api\") { path(\"/**\") filters { rewritePath(\"/(?/?.*)\", \"/customers/$\\\\{segment}\") } uri(\"http://localhost:8080/\") } } } } } ) } Start the application with the foo profile with -Dspring-boot.run.profiles=foo and check again the Routing Table.\nmvn spring-boot:run -Dspring-boot.run.profiles=foo http :8080/actuator/gateway/routes HTTP/1.1 200 OK Content-Type: application/json transfer-encoding: chunked [ { \"filters\": [ \"[[RewritePath api(?/?.*) = '/${segment}'], order = 0]\" ], \"order\": 0, \"predicate\": \"Paths: [/api/**], match trailing slash: true\", \"route_id\": \"sidecar-api\", \"uri\": \"http://localhost:8080\" }, { \"filters\": [ \"[[RewritePath /(?/?.*) = '/customers/${segment}'], order = 0]\" ], \"order\": 0, \"predicate\": \"Paths: [/**], match trailing slash: true\", \"route_id\": \"sidecar-root-to-customers-api\", \"uri\": \"http://localhost:8080/\" } ] The example source code can be found here GitHub kotlin-sidecar-gateway\n","wordCount":"725","inLanguage":"en","datePublished":"2020-04-16T00:00:00Z","dateModified":"2020-04-16T00:00:00Z","author":{"@type":"Person","name":"Marcel Widmer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.marcelwidmer.org/blog/2020/2020-04-12-cloud-gateway-sidecar/"},"publisher":{"@type":"Organization","name":"c3smonkey's blog","logo":{"@type":"ImageObject","url":"https://blog.marcelwidmer.org/static/favicon.ico"}}}</script></head><body><nav class=desktop><ul><li><a class=logo href=https://blog.marcelwidmer.org accesskey=h title="Welcome to my blog (Alt + h)"><img src=/static/favicon.ico alt="Welcome to my blog" width=35 height=35></img><h3 style=margin-bottom:0><strong><em>c3smonkey&rsquo;s blog</em></strong></h3></a></li><li class=toggle-container><input type=checkbox id=switch>
<label for=switch><i id=darkIcon data-feather=moon></i>
<i id=lightIcon data-feather=sun></i></label></li></ul><ul class=desktop-navigation><li><a href=/blog title=Blog><i data-feather=pen-tool></i>
<span>Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><i data-feather=search></i>
<span>Search</span></a></li><li><a href=/contact title=Contact><i data-feather=mail></i>
<span>Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><i data-feather=github></i>
<span></span></a></li></ul><ul class=mobile-navigation><li><button id=menuOpen onclick=openMobile() aria-label="Menu closed">
<i data-feather=menu></i></button>
<button id=menuClose onclick=openMobile() aria-label="Menu opened">
<i data-feather=x></i></button></li></ul></nav><aside class=sidebar id=mobileNav style=display:none><nav><ul><li><a href=/blog title=Blog><span><i data-feather=pen-tool></i>
Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><span><i data-feather=search></i>
Search</span></a></li><li><a href=/contact title=Contact><span><i data-feather=mail></i>
Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><span><i data-feather=github></i></span></a></li></ul></nav></aside><main><div class=container><hgroup><div><a href=https://blog.marcelwidmer.org>Home</a>&nbsp;»&nbsp;<a href=https://blog.marcelwidmer.org/blog/>Blog</a></div><h1>Spring Cloud Gateway</h1><time datetime='2020-04-16 00:00:00 +0000 UTC'>April 16, 2020</time>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Marcel Widmer<p></p></hgroup><a href=https://blog.marcelwidmer.org/tags/spring-boot/><kbd>Spring Boot</kbd></a><div class="grid grid-main"><div><div class=post><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on twitter" href="https://twitter.com/intent/tweet/?text=Spring%20Cloud%20Gateway&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&hashtags=SpringBoot"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&title=Spring%20Cloud%20Gateway&summary=Spring%20Cloud%20Gateway&source=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&title=Spring%20Cloud%20Gateway"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on whatsapp" href="https://api.whatsapp.com/send?text=Spring%20Cloud%20Gateway%20-%20https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on telegram" href="https://telegram.me/share/url?text=Spring%20Cloud%20Gateway&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div><p>This sample show how easy you can put on an existing <code>API</code> the <code>Spring Cloud Gateway</code> as kind of <code>SideCar</code> where you can manage your Security, Logging etc.
Or just provide an other <code>Endpoint</code> <code>URL</code> like in this sample.</p><p>Let&rsquo;s create a Service with a Reactive Spring Boot Application and MongoDB and a Rest Endpoint.</p><p>We start with the <code>MongoDB</code> document class <code>Customer</code> and a <code>ReactiveCrudRepository</code> interface <code>CustomerRepository</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#a6e22e>@Document</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Customer</span>(<span style=color:#a6e22e>@Id</span> <span style=color:#66d9ef>val</span> id: String = UUID.randomUUID().toString(), <span style=color:#66d9ef>val</span> name: String)
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>CustomerRepository</span> : ReactiveCrudRepository&lt;Customer, String&gt;
</span></span></code></pre></div><p>Now let&rsquo;s also create a service class <code>CustomerService</code> for it where we provide the following functionality.</p><ul><li>save</li><li>findAll</li><li>deleteAll</li><li>findById</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#a6e22e>@Service</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CustomerService</span>(<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> customerRepository: CustomerRepository) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>save</span>(customer: Customer) = customerRepository.save(customer)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>findAll</span>() = customerRepository.findAll()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>deleteAll</span>() = customerRepository.deleteAll()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>findById</span>(id: String) = customerRepository.findById(id)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>That we have some data we create a little functionality on application start with the <code>ApplicationRunner</code> from Spring Boot.<br>Let&rsquo;s create a Bean definition for the <code>ApplicationRunner</code> that delete first all entries and then save some sample values to it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>main</span>(args: Array&lt;String&gt;) {
</span></span><span style=display:flex><span>    runApplication&lt;SidecarGatewayApplication&gt;(*args) {
</span></span><span style=display:flex><span>        addInitializers(
</span></span><span style=display:flex><span>            beans {
</span></span><span style=display:flex><span>                bean {
</span></span><span style=display:flex><span>                    ApplicationRunner {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>val</span> customerService = ref&lt;CustomerService&gt;()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>                        customerService
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// first cleanUp Database
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            .deleteAll()
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// create a list of Customers 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            .thenMany(  
</span></span><span style=display:flex><span>                                listOf(<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Jane&#34;</span>, <span style=color:#e6db74>&#34;Jack&#34;</span>)
</span></span><span style=display:flex><span>                                    .toFlux()
</span></span><span style=display:flex><span>                                    .map { Customer(name = <span style=color:#66d9ef>it</span>) })
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// Save it to the Database
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            .flatMap { customerService.save(<span style=color:#66d9ef>it</span>) } 
</span></span><span style=display:flex><span>                             <span style=color:#75715e>// Search all entries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            .thenMany(customerService.findAll()) 
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// subscribe - let`s do the work...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            .subscribe { log.info(<span style=color:#e6db74>&#34;--&gt; </span><span style=color:#e6db74>$it</span><span style=color:#e6db74>&#34;</span>) } 
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we have some data in our MongoDB I think now is time to create a other Bean with the Kotlin DSL that provide a Rest endpoint.
For this we create an <code>Router</code> that will provide the following endpoints.</p><ul><li><code>/customers</code></li><li><code>/customers/{id}</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// Rest API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>bean {
</span></span><span style=display:flex><span>    router {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> customerService = ref&lt;CustomerService&gt;()
</span></span><span style=display:flex><span>        GET(<span style=color:#e6db74>&#34;/customers&#34;</span>) { 
</span></span><span style=display:flex><span>            ok().body(customerService.findAll()) 
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        GET(<span style=color:#e6db74>&#34;/customers/{id}&#34;</span>) { 
</span></span><span style=display:flex><span>            ok().body(customerService.findById(<span style=color:#66d9ef>it</span>.pathVariable(<span style=color:#e6db74>&#34;id&#34;</span>))) 
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>When we start now our application we can call the endpoint and hopefully we get a result like below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn spring-boot:run
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http :8080/customers
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>transfer-encoding: chunked
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;a16c9582-0f40-4a7b-a566-372a56c3d5c8&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;John&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;944c3752-55c5-4ede-bc09-e02a5e47b390&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Jane&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;478ce3f9-0eff-4018-a056-0656cd2c5ad4&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Jack&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Now let&rsquo;s create a sidecar with <code>Spring cloud Gateway</code> that provide another Rest API <code>/api/customers</code> and <code>/api/customers/{id}</code>
Let&rsquo;s create an additional response header <code>X-AnotherHeader</code> with the value <code>SideCar</code> as well.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// Gateway Sidecar API
</span></span></span><span style=display:flex><span><span style=color:#75715e>// http -v :8080/api/customers
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Gateway - Sidecar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>bean {
</span></span><span style=display:flex><span>    ref&lt;RouteLocatorBuilder&gt;()
</span></span><span style=display:flex><span>        .routes {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// http -v :8080/api/customers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            route(<span style=color:#e6db74>&#34;sidecar-api&#34;</span>) {
</span></span><span style=display:flex><span>                path(<span style=color:#e6db74>&#34;/api/**&#34;</span>)
</span></span><span style=display:flex><span>                filters {
</span></span><span style=display:flex><span>                    rewritePath(<span style=color:#e6db74>&#34;api(?&lt;segment&gt;/?.*)&#34;</span>, <span style=color:#e6db74>&#34;/$</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>{segment}&#34;</span>)
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                uri(<span style=color:#e6db74>&#34;http://localhost:8080&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>When we call now the EndPoint <code>/api/customers</code> we expect that we get the result from before and the additional <code>ResponsHeader</code>
with <code>X-AnotherHeader: SideCar</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http -v :8080/api/customers
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /api/customers HTTP/1.1
</span></span><span style=display:flex><span>Accept: */*
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Connection: keep-alive
</span></span><span style=display:flex><span>Host: localhost:8080
</span></span><span style=display:flex><span>User-Agent: HTTPie/2.0.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>X-AnotherHeader: SideCar
</span></span><span style=display:flex><span>transfer-encoding: chunked
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;a36f75ae-a97f-41ba-9b38-59a5a6d38055&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;John&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;c0b25559-13ad-4b6b-ae25-adbcd898db82&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Jane&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;2a3a1350-4bea-4504-b732-5b7c97602ebb&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Jack&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>With the Kotlin DSL Route definition is it also easy to create routes only for specifics Spring profiles.</p><p>The following command will start the application with the <code>default</code> profile.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn spring-boot:run
</span></span></code></pre></div><p><code>Spring Cloud Gateway</code> provide with the <code>Actuator</code> library an endpoint to check the configured routes.
Also let&rsquo;s check first our Routing Table whe we start the application with the default Spring Profile.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http :8080/actuator/gateway/routes
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>transfer-encoding: chunked
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;filters&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;[[RewritePath api(?&lt;segment&gt;/?.*) = &#39;/</span><span style=color:#e6db74>${</span>segment<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;], order = 0]&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;order&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;predicate&#34;</span>: <span style=color:#e6db74>&#34;Paths: [/api/**], match trailing slash: true&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route_id&#34;</span>: <span style=color:#e6db74>&#34;sidecar-api&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;uri&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:8080&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Now create a Route just for a specific Spring Profile <code>foo</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>    runApplication&lt;SidecarGatewayApplication&gt;(*args) {
</span></span><span style=display:flex><span>        addInitializers(
</span></span><span style=display:flex><span>            beans {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Profile
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                profile(<span style=color:#e6db74>&#34;foo&#34;</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Gateway - Sidecar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    bean {
</span></span><span style=display:flex><span>                        ref&lt;RouteLocatorBuilder&gt;()
</span></span><span style=display:flex><span>                            .routes {
</span></span><span style=display:flex><span>                                <span style=color:#75715e>// http -v :8080/
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                                route(<span style=color:#e6db74>&#34;sidecar-root-to-customers-api&#34;</span>) {
</span></span><span style=display:flex><span>                                    path(<span style=color:#e6db74>&#34;/**&#34;</span>)
</span></span><span style=display:flex><span>                                    filters {
</span></span><span style=display:flex><span>                                        rewritePath(<span style=color:#e6db74>&#34;/(?&lt;segment&gt;/?.*)&#34;</span>, <span style=color:#e6db74>&#34;/customers/$</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>{segment}&#34;</span>)
</span></span><span style=display:flex><span>                                    }
</span></span><span style=display:flex><span>                                    uri(<span style=color:#e6db74>&#34;http://localhost:8080/&#34;</span>)
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Start the application with the <code>foo</code> profile with <code>-Dspring-boot.run.profiles=foo</code> and check again the Routing Table.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mvn spring-boot:run -Dspring-boot.run.profiles<span style=color:#f92672>=</span>foo
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http :8080/actuator/gateway/routes
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>transfer-encoding: chunked
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;filters&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;[[RewritePath api(?&lt;segment&gt;/?.*) = &#39;/</span><span style=color:#e6db74>${</span>segment<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;], order = 0]&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;order&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;predicate&#34;</span>: <span style=color:#e6db74>&#34;Paths: [/api/**], match trailing slash: true&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route_id&#34;</span>: <span style=color:#e6db74>&#34;sidecar-api&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;uri&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:8080&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;filters&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;[[RewritePath /(?&lt;segment&gt;/?.*) = &#39;/customers/</span><span style=color:#e6db74>${</span>segment<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;], order = 0]&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>]</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;order&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;predicate&#34;</span>: <span style=color:#e6db74>&#34;Paths: [/**], match trailing slash: true&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route_id&#34;</span>: <span style=color:#e6db74>&#34;sidecar-root-to-customers-api&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;uri&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:8080/&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>The example source code can be found here <a href=https://github.com/marzelwidmer/kotlin-sidecar-gateway target=_blank rel=noopener>GitHub kotlin-sidecar-gateway</a></p></div><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on twitter" href="https://twitter.com/intent/tweet/?text=Spring%20Cloud%20Gateway&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&hashtags=SpringBoot"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&title=Spring%20Cloud%20Gateway&summary=Spring%20Cloud%20Gateway&source=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f&title=Spring%20Cloud%20Gateway"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on whatsapp" href="https://api.whatsapp.com/send?text=Spring%20Cloud%20Gateway%20-%20https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Spring Cloud Gateway on telegram" href="https://telegram.me/share/url?text=Spring%20Cloud%20Gateway&url=https%3a%2f%2fblog.marcelwidmer.org%2fblog%2f2020%2f2020-04-12-cloud-gateway-sidecar%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></div><aside><article><h3>See Also</h3><a href=/blog/2020/2020-04-12-spring-initializr/><hgroup><h4><i>Create Kotlin Project with Spring Initializr and HTTPie</i></h4><p><time datetime='2020-04-12 00:00:00 +0000 UTC'>April 12, 2020</time>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-10-22-axon/><hgroup><h4><i>AxonIQ</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-08-28-multiple-project-promoting/><hgroup><h4><i>Promoting Applications Across Environments</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-09-18-spring-boot-k8s-configmap/><hgroup><h4><i>Spring Boot Kubernetes ConfigMap</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-09-21-spring-boot-k8s-ribbon-discovery/><hgroup><h4><i>Spring Boot Kubernetes Discovery</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a></article></aside></div></div></main><footer class=text-center><span>&copy; 2022 <a href=https://blog.marcelwidmer.org>c3smonkey's blog</a></span><div><a href=https://blog.marcelwidmer.org/legal/privacy>Privacy Policy</a>
<span>&</span>
<a href=https://blog.marcelwidmer.org/legal/terms-and-conditions>Terms and Conditions</a></div></footer><article class=hidden id=cookie-banner><div><span></span></div><footer><a role=button id=consent-cookies>Close</a>
<a role=button class=secondary href=/></a></footer></article><script async src=https://blog.marcelwidmer.org/js/cookie.min.js layout=container></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("kbd");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://blog.marcelwidmer.org/plugins/js/feather.min.js layout=container></script>
<script src=https://blog.marcelwidmer.org/js/script.min.js layout=container></script></body></html>