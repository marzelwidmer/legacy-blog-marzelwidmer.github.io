<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Kboot Flux Meets Soap | c3smonkey's blog</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This will demonstrate how we can deal with a Blocking API in a Reactive World.
The GitHb 1 sample provides a
soap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API."><meta name=author content="Marcel Widmer"><link rel=canonical href=https://blog.marcelwidmer.org/blog/2020/2020-05-10-kboot-flux-meets-soap/><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/main.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/nav.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/plugins/css/pico.min.css><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=apple-touch-icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=mask-icon href=https://blog.marcelwidmer.org/static/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.1"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Kboot Flux Meets Soap"><meta name=twitter:description content="This will demonstrate how we can deal with a Blocking API in a Reactive World.
The GitHb 1 sample provides a
soap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API."><meta property="og:title" content="Kboot Flux Meets Soap"><meta property="og:description" content="This will demonstrate how we can deal with a Blocking API in a Reactive World.
The GitHb 1 sample provides a
soap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.marcelwidmer.org/blog/2020/2020-05-10-kboot-flux-meets-soap/"><meta property="og:image" content="https://blog.marcelwidmer.org/static"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-05-10T00:00:00+00:00"><meta property="article:modified_time" content="2020-05-10T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Kboot Flux Meets Soap"><meta name=twitter:description content="This will demonstrate how we can deal with a Blocking API in a Reactive World.
The GitHb 1 sample provides a
soap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blog","item":"https://blog.marcelwidmer.org/blog/"},{"@type":"ListItem","position":3,"name":"Kboot Flux Meets Soap","item":"https://blog.marcelwidmer.org/blog/2020/2020-05-10-kboot-flux-meets-soap/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kboot Flux Meets Soap","name":"Kboot Flux Meets Soap","description":"This will demonstrate how we can deal with a Blocking API in a Reactive World.\nThe GitHb 1 sample provides a\nsoap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API.","keywords":[],"articleBody":"This will demonstrate how we can deal with a Blocking API in a Reactive World.\nThe GitHb 1 sample provides a\nsoap-server who demonstrate the blocking downstream API. flux-client with REST API lockdown that will call the blocking SOAP endpoint and. Blockhound 2 will throw an exception. easing have an implemented from Avoiding Reactor Meltdown 3 show case how to manage Blocking API. With this approach to manage Blocking API in the same service ant not in a separate service we have all the nice features like retry filter map and so on in our Service A from the Reactive Streams API.\nWe also not have to manage a other service who will handle it for us. With this we have less network hops, Organisations-Issues, Deployment etc. who are sometimes increase complexity and so on.\nRest API BlockHound Plugin SOAP Server SOAP with HTTPie Server Implementation Flux Client API Lockdown Switzerland http :8080/api/lockdown/Switzerland API easing Switzerland http :8080/api/easing/Switzerland Blockhound BlockHound is a Java agent to detect blocking calls from non-blocking threads. Add the following or latest dependency from blockhound.\nio.projectreactor.tools blockhound 1.0.3.RELEASE Install the agent BlockHound.install()\nfun main(args: Array) { BlockHound.install() runApplication(*args) } SOAP Server The Server have an implementation with a demonstration how we can write own Kotlin DSL.\nDSL 4 country { name = \"Switzerland\" capital = \"Bern\" population = 8_603_900 currency = \"CHF\" } WSDL http://localhost:8888/ws/countries.wsdl\nEnd-Point http://localhost:8888/ws\nRequest ","wordCount":"385","inLanguage":"en","datePublished":"2020-05-10T00:00:00Z","dateModified":"2020-05-10T00:00:00Z","author":{"@type":"Person","name":"Marcel Widmer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.marcelwidmer.org/blog/2020/2020-05-10-kboot-flux-meets-soap/"},"publisher":{"@type":"Organization","name":"c3smonkey's blog","logo":{"@type":"ImageObject","url":"https://blog.marcelwidmer.org/static/favicon.ico"}}}</script></head><body><nav class=desktop><ul><li><a class=logo href=https://blog.marcelwidmer.org accesskey=h title="Welcome to my blog (Alt + h)"><img src=/static/favicon.ico alt="Welcome to my blog" width=35 height=35></img><h3 style=margin-bottom:0><strong><em>c3smonkey&rsquo;s blog</em></strong></h3></a></li><li class=toggle-container><input type=checkbox id=switch>
<label for=switch><i id=darkIcon data-feather=moon></i>
<i id=lightIcon data-feather=sun></i></label></li></ul><ul class=desktop-navigation><li><a href=/blog title=Blog><i data-feather=pen-tool></i>
<span>Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><i data-feather=search></i>
<span>Search</span></a></li><li><a href=/contact title=Contact><i data-feather=mail></i>
<span>Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><i data-feather=github></i>
<span></span></a></li></ul><ul class=mobile-navigation><li><button id=menuOpen onclick=openMobile() aria-label="Menu closed">
<i data-feather=menu></i></button>
<button id=menuClose onclick=openMobile() aria-label="Menu opened">
<i data-feather=x></i></button></li></ul></nav><aside class=sidebar id=mobileNav style=display:none><nav><ul><li><a href=/blog title=Blog><span><i data-feather=pen-tool></i>
Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><span><i data-feather=search></i>
Search</span></a></li><li><a href=/contact title=Contact><span><i data-feather=mail></i>
Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><span><i data-feather=github></i></span></a></li></ul></nav></aside><main><div class=container><hgroup><div><a href=https://blog.marcelwidmer.org>Home</a>&nbsp;»&nbsp;<a href=https://blog.marcelwidmer.org/blog/>Blog</a></div><h1>Kboot Flux Meets Soap</h1><time datetime='2020-05-10 00:00:00 +0000 UTC'>May 10, 2020</time>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Marcel Widmer<p></p></hgroup><div class="grid grid-main"><div><article class=toc><div><details open><summary accesskey=c title="(Alt + C)"><span>Table of Contents</span></summary><div><ul><li><a href=#restAPI aria-label="Flux Client ">Flux Client</a><ul><li><a href=#api-lockdown-switzerland aria-label="API Lockdown Switzerland">API Lockdown Switzerland</a></li><li><a href=#api-easing-switzerland aria-label="API easing Switzerland">API easing Switzerland</a></li><li><a href=#blockHound aria-label="Blockhound ">Blockhound</a></li></ul></li><li><a href=#soapServer aria-label="SOAP Server ">SOAP Server</a><ul><li><a href=#dsl-kotlindslinunderanhour aria-label="DSL 4">DSL <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></a></li><li><a href=#wsdl aria-label=WSDL>WSDL</a></li><li><a href=#end-point aria-label=End-Point>End-Point</a></li><li><a href=#request aria-label=Request>Request</a></li><li><a href=#httpieSoapCall aria-label="Call Service with HTTPie ">Call Service with <code>HTTPie</code></a></li></ul></li><li><a href=#implementation aria-label="Implementation ">Implementation</a><ul><li><a href=#router-table aria-label="Router Table">Router Table</a></li><li><a href=#reactive-service aria-label="Reactive Service">Reactive Service</a></li><li><a href=#reactive-soap-client aria-label="Reactive SOAP Client">Reactive SOAP Client</a></li></ul></li></ul></div></details></div></article><div class=post><div class=share-buttons></div><p>This will demonstrate how we can deal with a <code>Blocking API</code> in a <code>Reactive World</code>.</p><p>The GitHb <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> sample provides a</p><ul><li><code>soap-server</code> who demonstrate the blocking downstream <code>API</code>.</li><li><code>flux-client</code> with <code>REST API</code><ul><li><code>lockdown</code> that will call the blocking <code>SOAP</code> endpoint and. Blockhound <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> will throw an exception.</li><li><code>easing</code> have an implemented from Avoiding Reactor Meltdown <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> show case how to manage <code>Blocking API</code>.</li></ul></li></ul><p>With this approach to manage <code>Blocking API</code> in the same service ant not in a separate service we have all the nice features like <code>retry</code> <code>filter</code> <code>map</code> and so on
in our <code>Service A</code> from the <code>Reactive Streams API</code>.</p><p>We also not have to manage a other service who will handle it for us. With this we have less network hops, Organisations-Issues, Deployment etc. who are sometimes increase complexity and so on.</p><ul><li><a href=#restAPI>Rest API</a></li><li><a href=#blockHound>BlockHound Plugin</a></li><li><a href=#soapServer>SOAP Server</a></li><li><a href=#httpieSoapCall>SOAP with HTTPie Server</a></li><li><a href=#implementation>Implementation</a></li></ul><p><img src=/static/flux-meets-soap/FluxMeetsSoap.png alt=fluxMeetsSoap></p><h1 id=restAPI>Flux Client <a class=anchor aria-hidden=true href=#restAPI>#</a></h1><h2 id=api-lockdown-switzerland>API Lockdown Switzerland<a class=anchor aria-hidden=true href=#api-lockdown-switzerland>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http :8080/api/lockdown/Switzerland
</span></span></code></pre></div><h2 id=api-easing-switzerland>API easing Switzerland<a class=anchor aria-hidden=true href=#api-easing-switzerland>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http :8080/api/easing/Switzerland
</span></span></code></pre></div><h2 id=blockHound>Blockhound <a class=anchor aria-hidden=true href=#blockHound>#</a></h2><p><a href=https://github.com/reactor/BlockHound target=_blank rel=noopener>BlockHound</a> is a Java agent to detect blocking calls from non-blocking threads.
Add the following or latest dependency from <code>blockhound</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!-- Blockhound	--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>io.projectreactor.tools<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>blockhound<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;version&gt;</span>1.0.3.RELEASE<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>Install the agent <code>BlockHound.install()</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>main</span>(args: Array&lt;String&gt;) {
</span></span><span style=display:flex><span>	BlockHound.install()
</span></span><span style=display:flex><span>	runApplication&lt;KbootFluxWS&gt;(*args)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=soapServer>SOAP Server <a class=anchor aria-hidden=true href=#soapServer>#</a></h1><p>The Server have an implementation with a demonstration how we can write own <code>Kotlin DSL</code>.</p><h2 id=dsl-kotlindslinunderanhour>DSL <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup><a class=anchor aria-hidden=true href=#dsl-kotlindslinunderanhour>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span> country {
</span></span><span style=display:flex><span>    name = <span style=color:#e6db74>&#34;Switzerland&#34;</span>
</span></span><span style=display:flex><span>    capital = <span style=color:#e6db74>&#34;Bern&#34;</span>
</span></span><span style=display:flex><span>    population = <span style=color:#ae81ff>8</span>_603_900
</span></span><span style=display:flex><span>    currency = <span style=color:#e6db74>&#34;CHF&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=wsdl>WSDL<a class=anchor aria-hidden=true href=#wsdl>#</a></h2><p><code>http://localhost:8888/ws/countries.wsdl</code></p><h2 id=end-point>End-Point<a class=anchor aria-hidden=true href=#end-point>#</a></h2><p><code>http://localhost:8888/ws</code></p><h2 id=request>Request<a class=anchor aria-hidden=true href=#request>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;soapenv:Envelope</span> <span style=color:#a6e22e>xmlns:soapenv=</span><span style=color:#e6db74>&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;</span>
</span></span><span style=display:flex><span>				  <span style=color:#a6e22e>xmlns:gs=</span><span style=color:#e6db74>&#34;http://keepcalm.ch/web-services&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;soapenv:Header/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;soapenv:Body&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;gs:getCountryRequest&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>&lt;gs:name&gt;</span>Switzerland<span style=color:#f92672>&lt;/gs:name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/gs:getCountryRequest&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;/soapenv:Body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/soapenv:Envelope&gt;</span>
</span></span></code></pre></div><h2 id=httpieSoapCall>Call Service with <code>HTTPie</code> <a class=anchor aria-hidden=true href=#httpieSoapCall>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>printf <span style=color:#e6db74>&#39;&lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                                  xmlns:gs=&#34;http://keepcalm.ch/web-services&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   &lt;soapenv:Header/&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   &lt;soapenv:Body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;gs:getCountryRequest&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         &lt;gs:name&gt;Switzerland&lt;/gs:name&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      &lt;/gs:getCountryRequest&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   &lt;/soapenv:Body&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/soapenv:Envelope&gt;&#39;</span>| http  --follow --timeout <span style=color:#ae81ff>3600</span> POST http://localhost:8888/ws <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> Content-Type:<span style=color:#e6db74>&#39;text/xml&#39;</span>
</span></span></code></pre></div><h1 id=implementation>Implementation <a class=anchor aria-hidden=true href=#implementation>#</a></h1><h2 id=router-table>Router Table<a class=anchor aria-hidden=true href=#router-table>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span>bean {
</span></span><span style=display:flex><span>    router {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;api&#34;</span>.nest {
</span></span><span style=display:flex><span>            GET(<span style=color:#e6db74>&#34;/lockdown/{name}&#34;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>val</span> countryService = ref&lt;CountryService&gt;()
</span></span><span style=display:flex><span>                ok().body(BodyInserters.fromValue(
</span></span><span style=display:flex><span>                    countryService.getCountryByName(<span style=color:#66d9ef>it</span>.pathVariable(<span style=color:#e6db74>&#34;name&#34;</span>)))
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            GET(<span style=color:#e6db74>&#34;/easing/{name}&#34;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>val</span> countryReactiveService = ref&lt;CountryReactiveService&gt;()
</span></span><span style=display:flex><span>                ok().body(
</span></span><span style=display:flex><span>                    BodyInserters.fromPublisher(countryReactiveService.getCountryByName(<span style=color:#66d9ef>it</span>.pathVariable(<span style=color:#e6db74>&#34;name&#34;</span>)), GetCountryResponse<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=reactive-service>Reactive Service<a class=anchor aria-hidden=true href=#reactive-service>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#a6e22e>@Service</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CountryReactiveService</span>  (<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> soapClient: SoapClient) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getCountryByName</span>(name: String): Mono&lt;GetCountryResponse&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> soapClient.getCountryReactive(name)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=reactive-soap-client>Reactive SOAP Client<a class=anchor aria-hidden=true href=#reactive-soap-client>#</a></h2><p><code>.subscribeOn(Schedulers.boundedElastic())</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getCountryReactive</span>(country: String): Mono&lt;GetCountryResponse&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> request = GetCountryRequest()
</span></span><span style=display:flex><span>    request.name = country
</span></span><span style=display:flex><span>    log.info(<span style=color:#e6db74>&#34;Requesting location for </span><span style=color:#e6db74>$country</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Mono.fromCallable {
</span></span><span style=display:flex><span>        webServiceTemplate
</span></span><span style=display:flex><span>            .marshalSendAndReceive(<span style=color:#e6db74>&#34;http://localhost:8888/ws/countries&#34;</span>, request,
</span></span><span style=display:flex><span>                SoapActionCallback(
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;http://keepcalm.ch/web-services/GetCountryRequest&#34;</span>)) <span style=color:#66d9ef>as</span> GetCountryResponse
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// properly schedule above blocking call on
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// scheduler meant for blocking tasks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .subscribeOn(Schedulers.boundedElastic())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://github.com/marzelwidmer/kboot-flux-meets-soap target=_blank rel=noopener>kboot-flux-meets-soap</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://github.com/reactor/BlockHound target=_blank rel=noopener>Blockhound</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href="https://youtu.be/xCu73WVg8Ps?t=1" target=_blank rel=noopener>Avoiding Reactor Meltdown</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href="https://www.youtube.com/watch?v=zYNbsVv9oN0" target=_blank rel=noopener>Kotlin DSL in under an hour</a> | <a href="https://www.youtube.com/watch?v=hYXAFO3q3qU" target=_blank rel=noopener>Do Super Language with Kotlin</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=share-buttons></div></div><aside><article></article></aside></div></div></main><footer class=text-center><span>&copy; 2022 <a href=https://blog.marcelwidmer.org>c3smonkey's blog</a></span><div><a href=https://blog.marcelwidmer.org/legal/privacy>Privacy Policy</a>
<span>&</span>
<a href=https://blog.marcelwidmer.org/legal/terms-and-conditions>Terms and Conditions</a></div></footer><article class=hidden id=cookie-banner><div><span></span></div><footer><a role=button id=consent-cookies>Close</a>
<a role=button class=secondary href=/></a></footer></article><script async src=https://blog.marcelwidmer.org/js/cookie.min.js layout=container></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("kbd");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://blog.marcelwidmer.org/plugins/js/feather.min.js layout=container></script>
<script src=https://blog.marcelwidmer.org/js/script.min.js layout=container></script></body></html>