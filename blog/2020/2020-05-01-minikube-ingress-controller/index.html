<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Kubernetes Ingress with Ngnix Ingress Controller | c3smonkey's blog</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl
Install Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for &#34;minikube&#34; ... 🐳 Preparing Kubernetes v1."><meta name=author content="Marcel Widmer"><link rel=canonical href=https://blog.marcelwidmer.org/blog/2020/2020-05-01-minikube-ingress-controller/><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/main.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/sass/nav.min.css><link rel=stylesheet href=https://blog.marcelwidmer.org/plugins/css/pico.min.css><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=apple-touch-icon href=https://blog.marcelwidmer.org/static/favicon.ico><link rel=mask-icon href=https://blog.marcelwidmer.org/static/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.1"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Kubernetes Ingress with Ngnix Ingress Controller"><meta name=twitter:description content="OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl
Install Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for &#34;minikube&#34; ... 🐳 Preparing Kubernetes v1."><meta property="og:title" content="Kubernetes Ingress with Ngnix Ingress Controller"><meta property="og:description" content="OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl
Install Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for &#34;minikube&#34; ... 🐳 Preparing Kubernetes v1."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.marcelwidmer.org/blog/2020/2020-05-01-minikube-ingress-controller/"><meta property="og:image" content="https://blog.marcelwidmer.org/static"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-05-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.marcelwidmer.org/static"><meta name=twitter:title content="Kubernetes Ingress with Ngnix Ingress Controller"><meta name=twitter:description content="OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl
Install Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for &#34;minikube&#34; ... 🐳 Preparing Kubernetes v1."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blog","item":"https://blog.marcelwidmer.org/blog/"},{"@type":"ListItem","position":3,"name":"Kubernetes Ingress with Ngnix Ingress Controller","item":"https://blog.marcelwidmer.org/blog/2020/2020-05-01-minikube-ingress-controller/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kubernetes Ingress with Ngnix Ingress Controller","name":"Kubernetes Ingress with Ngnix Ingress Controller","description":"OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl\nInstall Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for \u0026#34;minikube\u0026#34; ... 🐳 Preparing Kubernetes v1.","keywords":["k8s"],"articleBody":"OSX Minikube Kubernetes If you use ohmyzsh is there a nice Plugin with some kubectl for more details check ohmyzsh plugins kubectl\nInstall Minikube with Ingress Controller brew install minikube Start Minikube minikube start 😄 minikube v1.9.2 on Darwin 10.15.4 ▪ MINIKUBE_ACTIVE_DOCKERD=minikube ✨ Using the hyperkit driver based on existing profile 👍 Starting control plane node m01 in cluster minikube 🔄 Restarting existing hyperkit VM for \"minikube\" ... 🐳 Preparing Kubernetes v1.18.0 on Docker 19.03.8 ... 🌟 Enabling addons: dashboard, default-storageclass, ingress, storage-provisioner 🏄 Done! kubectl is now configured to use \"minikube\" Minkikube Status minikube status m01 host: Running kubelet: Running apiserver: Running kubeconfig: Configured Enable Ingress Addons We need the addon ingress this can be done with the followng command.\nminikube addons enable ingress Check minikube addons with minikube addons list if ingress is enabled.\nRun the following command:\nminikube addons list |-----------------------------|----------|--------------| | ADDON NAME | PROFILE | STATUS | |-----------------------------|----------|--------------| | dashboard | minikube | enabled ✅ | | default-storageclass | minikube | enabled ✅ | | efk | minikube | disabled | | freshpod | minikube | disabled | | gvisor | minikube | disabled | | helm-tiller | minikube | disabled | | ingress | minikube | enabled ✅ | | ingress-dns | minikube | disabled | | istio | minikube | disabled | | istio-provisioner | minikube | disabled | | logviewer | minikube | disabled | | metrics-server | minikube | disabled | | nvidia-driver-installer | minikube | disabled | | nvidia-gpu-device-plugin | minikube | disabled | | registry | minikube | disabled | | registry-aliases | minikube | disabled | | registry-creds | minikube | disabled | | storage-provisioner | minikube | enabled ✅ | | storage-provisioner-gluster | minikube | disabled | |-----------------------------|----------|--------------| Ingress Controller Let’s check if the Nginx Ingress Controller is up and running.\nRun the following command:\nk get pods -n kube-system | grep nginx-ingress nginx-ingress-controller-6d57c87cb9-rtgpk 1/1 Running 1 12m Create Namespace Let’s create first a dev name space where we deploy our sample application.\nRun the following command:\nk create ns dev namespace/dev created Switch Namespace Permanently With the following command we can switch the namespace permanently like oc project in a OpenShift environment. This command will save the namespace for all other kubectl commands in that context. This required the ohmyzsh plugins kubectl Plugin. Without this plugin will be the command kubectl config set-context --current --namespace=dev.\nkcn dev Create Deployment Let’s create a deployment now for a sample application with the name myapp with the image google-samples/hello-app:1.0 in the current namespace dev\nRun the following command:\nk create deployment myapp --image=gcr.io/google-samples/hello-app:1.0 deployment.apps/myapp created If you want see what deployments we have you can use kubectl get deployments command.\nRun the following command:\nk get deployments NAME READY UP-TO-DATE AVAILABLE AGE myapp 1/1 1 1 44m Let’s also check if the pod is running.\nRun the following command:\nk get pods -n dev -o wide --show-labels --field-selector=status.phase=Running NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES LABELS myapp-75d86849b-2gbps 1/1 Running 0 67m 172.17.0.3 minikube app=myapp,pod-template-hash=75d86849b Create Service To reach our application we have to create a service this can be easily done with the expose command and the NodePort\nk expose deployment myapp --port=8080 --type=NodePort Let’s check the service.\nRun the following command:\nk get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE myapp NodePort 10.110.101.126 8080:30506/TCP 21m Test Service internal in a Cluster Let’s check the service with a small container based on the tutum/curl:alpine Docker image, which contains the curl command. Run the curl -s 'http://myapp:8080' command inside the container and redirect the output to the Terminal using the -i option. Delete the pod using the --rm option.\nRun the following command:\nk run -i --rm --restart=Never curl-client --image=tutum/curl:alpine --command -- curl -s 'http://myapp:8080' Hello, world! Version: 1.0.0 Hostname: myapp-75d86849b-2gbps pod \"curl-client\" deleted This mean we can call a pod internal a cluster with the internal DNS.\nTest Service outside a Cluster Let’s call again the command k get svc to get the exposed port from out service. Run the following command again :\nk get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE myapp NodePort 10.110.101.126 8080:30506/TCP 21m You see the exposed port is here 30506 now let’s get the IP address from out minikube with minikube ip\nminikube ip 192.168.64.18 Now let’s also call out service myapp with HTTPie or in a browser http://192.168.64.18:30506\nhttp http://192.168.64.18:30506 HTTP/1.1 200 OK Content-Length: 61 Content-Type: text/plain; charset=utf-8 Date: Sun, 03 May 2020 08:07:35 GMT Hello, world! Version: 1.0.0 Hostname: myapp-75d86849b-2gbps /etc/hosts To get on the service with the URL minikube.me we update now out local /etc/hosts file with IP address from your minikube minikube ip Run the following command:\necho $(minikube ip) minikube.me | sudo tee -a /etc/hosts Password: 192.168.64.11 minikube.me Verify it the IP is in the /etc/hosts with the following command:\ncat /etc/hosts | tail -n 1 192.168.64.11 minikube.me Now you can also call the service wit the DNS http://minikube.me:30506\nhttp http://minikube.me:30506 HTTP/1.1 200 OK Content-Length: 61 Content-Type: text/plain; charset=utf-8 Date: Sun, 03 May 2020 08:12:51 GMT Hello, world! Version: 1.0.0 Hostname: myapp-75d86849b-2gbps Nginx Ingress Now is time to create our nginx ingress for this we creat a file named nginx-ingess.yaml where we point / to the myapp service on internal port 8080.\nRun the following command:\necho \"apiVersion: networking.k8s.io/v1beta1 # for versions before 1.14 use extensions/v1beta1 kind: Ingress metadata: name: nginx-ingress namespace: dev annotations: nginx.ingress.kubernetes.io/rewrite-target: /$1 spec: rules: - host: minikube.me http: paths: - path: / backend: serviceName: myapp servicePort: 8080\" | \u003e nginx-ingess.yaml Now let’s also take a new alias in the game kaf is the alias for kubectl -f and let’s apply the nginx-ingess.yaml file. For this run the following command:\nkaf nginx-ingess.yaml ingress.networking.k8s.io/nginx-ingress created With kubectl get ingress you can list all ingress in the namespace.\nk get ingress NAME CLASS HOSTS ADDRESS PORTS AGE nginx-ingress minikube.me 80 22s Test Ingress Open a browser now http://minikube.me or with HTTPie in a terminal.\nhttp http://minikube.me HTTP/1.1 200 OK Connection: keep-alive Content-Length: 61 Content-Type: text/plain; charset=utf-8 Date: Sun, 03 May 2020 09:18:45 GMT Server: openresty/1.15.8.2 Hello, world! Version: 1.0.0 Hostname: myapp-75d86849b-v72vs Now let’s also deploy a second application and expose it as service. Configure the nginx ingress also to the second service.\nk create deployment myapp2 --image=gcr.io/google-samples/hello-app:2.0 k expose deployment myapp2 --port=8080 --type=NodePort Update the nginx-ingess.yaml file with vi\n- path: /v2/* backend: serviceName: myapp2 servicePort: 8080 Check the nginx-ingess.yaml file with cat nginx-ingess.yaml\napiVersion: networking.k8s.io/v1beta1 # for versions before 1.14 use extensions/v1beta1 kind: Ingress metadata: name: nginx-ingress namespace: dev annotations: nginx.ingress.kubernetes.io/rewrite-target: / spec: rules: - host: minikube.me http: paths: - path: / backend: serviceName: myapp servicePort: 8080 - path: /v2 backend: serviceName: myapp2 servicePort: 8080 Apply the changes with the following command:\nkaf nginx-ingess.yaml ingress.networking.k8s.io/nginx-ingress configured Now we have one Ingress who point to 2 individual services. Verify it with HTTPie or with the browser http://minikube.me/ will give back Version: 1.0.0\nhttp http://minikube.me/ HTTP/1.1 200 OK Connection: keep-alive Content-Length: 61 Content-Type: text/plain; charset=utf-8 Date: Sun, 03 May 2020 09:31:12 GMT Server: openresty/1.15.8.2 Hello, world! Version: 1.0.0 Hostname: myapp-75d86849b-v72vs On the second route http://minikube.me/v2 we get back Version: 2.0.0\nhttp http://minikube.me/v2 HTTP/1.1 200 OK Connection: keep-alive Content-Length: 63 Content-Type: text/plain; charset=utf-8 Date: Sun, 03 May 2020 09:32:23 GMT Server: openresty/1.15.8.2 Hello, world! Version: 2.0.0 Hostname: myapp2-548b98644f-rqqmp kubectl Cheat Sheet k get pods -o wide --show-labels --field-selector=status.phase=Running -w | grep -vi \"Terminating\" NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES LABELS web-6785d44d5-vb2wb 1/1 Running 1 19h 172.17.0.4 minikube app=web,pod-template-hash=6785d44d5 web2 1/1 Running 1 19h 172.17.0.3 minikube run=web2 web2-8474c56fd-wk4kh 1/1 Running 1 18h 172.17.0.5 minikube app=web2,pod-template-hash=8474c56fd Namespaces kubectl get ns k get ns kgns k get ns NAME STATUS AGE default Active 19h kube-node-lease Active 19h kube-public Active 19h kube-system Active 19h Delete with given label k delete all -l app=web Troubleshooting sudo dscacheutil -flushcache;sudo killall -HUP mDNSResponder References:\ningress-minikube\n","wordCount":"1319","inLanguage":"en","datePublished":"2020-05-01T00:00:00Z","dateModified":"2020-05-01T00:00:00Z","author":{"@type":"Person","name":"Marcel Widmer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.marcelwidmer.org/blog/2020/2020-05-01-minikube-ingress-controller/"},"publisher":{"@type":"Organization","name":"c3smonkey's blog","logo":{"@type":"ImageObject","url":"https://blog.marcelwidmer.org/static/favicon.ico"}}}</script></head><body><nav class=desktop><ul><li><a class=logo href=https://blog.marcelwidmer.org accesskey=h title="Welcome to my blog (Alt + h)"><img src=/static/favicon.ico alt="Welcome to my blog" width=35 height=35></img><h3 style=margin-bottom:0><strong><em>c3smonkey&rsquo;s blog</em></strong></h3></a></li><li class=toggle-container><input type=checkbox id=switch>
<label for=switch><i id=darkIcon data-feather=moon></i>
<i id=lightIcon data-feather=sun></i></label></li></ul><ul class=desktop-navigation><li><a href=/blog title=Blog><i data-feather=pen-tool></i>
<span>Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><i data-feather=search></i>
<span>Search</span></a></li><li><a href=/contact title=Contact><i data-feather=mail></i>
<span>Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><i data-feather=github></i>
<span></span></a></li></ul><ul class=mobile-navigation><li><button id=menuOpen onclick=openMobile() aria-label="Menu closed">
<i data-feather=menu></i></button>
<button id=menuClose onclick=openMobile() aria-label="Menu opened">
<i data-feather=x></i></button></li></ul></nav><aside class=sidebar id=mobileNav style=display:none><nav><ul><li><a href=/blog title=Blog><span><i data-feather=pen-tool></i>
Blog</span></a></li><li><a href=/search title="Search (Alt + /)" accesskey=/><span><i data-feather=search></i>
Search</span></a></li><li><a href=/contact title=Contact><span><i data-feather=mail></i>
Contact</span></a></li><li><a href=https://github.com/marzelwidmer title=Github><span><i data-feather=github></i></span></a></li></ul></nav></aside><main><div class=container><hgroup><div><a href=https://blog.marcelwidmer.org>Home</a>&nbsp;»&nbsp;<a href=https://blog.marcelwidmer.org/blog/>Blog</a></div><h1>Kubernetes Ingress with Ngnix Ingress Controller</h1><time datetime='2020-05-01 00:00:00 +0000 UTC'>May 1, 2020</time>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Marcel Widmer<p></p></hgroup><a href=https://blog.marcelwidmer.org/tags/k8s/><kbd>k8s</kbd></a><div class="grid grid-main"><div><article class=toc><div><details open><summary accesskey=c title="(Alt + C)"><span>Table of Contents</span></summary><div><ul><li><a href=#osx-minikube-kubernetes aria-label="OSX Minikube Kubernetes">OSX Minikube Kubernetes</a><ul><li><a href=#install-minikube-with-ingress-controller aria-label="Install Minikube with Ingress Controller">Install Minikube with Ingress Controller</a></li><li><a href=#start-minikube aria-label="Start Minikube">Start Minikube</a></li><li><a href=#minkikube-status aria-label="Minkikube Status">Minkikube Status</a></li><li><a href=#enable-ingress-addons aria-label="Enable Ingress Addons">Enable Ingress Addons</a></li><li><a href=#ingress-controller aria-label="Ingress Controller">Ingress Controller</a></li></ul></li><li><a href=#create-namespace aria-label="Create Namespace">Create Namespace</a></li><li><a href=#switch-namespace-permanently aria-label="Switch Namespace Permanently">Switch Namespace Permanently</a></li><li><a href=#create-deployment aria-label="Create Deployment">Create Deployment</a></li><li><a href=#create-service aria-label="Create Service">Create Service</a><ul><li><a href=#test-service-internal-in-a-cluster aria-label="Test Service internal in a Cluster">Test Service internal in a Cluster</a></li><li><a href=#test-service-outside-a-cluster aria-label="Test Service outside a Cluster">Test Service outside a Cluster</a></li></ul></li><li><a href=#etchosts aria-label=/etc/hosts>/etc/hosts</a></li><li><a href=#nginx-ingress aria-label="Nginx Ingress">Nginx Ingress</a><ul><li><a href=#test-ingress aria-label="Test Ingress">Test Ingress</a></li></ul></li><li><a href=#kubectl-cheat-sheet aria-label="kubectl Cheat Sheet">kubectl Cheat Sheet</a><ul><li><a href=#namespaces aria-label=Namespaces>Namespaces</a></li><li><a href=#delete-with-given-label aria-label="Delete with given label">Delete with given label</a></li><li><a href=#troubleshooting aria-label=Troubleshooting>Troubleshooting</a></li></ul></li></ul></div></details></div></article><div class=post><div class=share-buttons></div><h1 id=osx-minikube-kubernetes>OSX Minikube Kubernetes<a class=anchor aria-hidden=true href=#osx-minikube-kubernetes>#</a></h1><p>If you use <code>ohmyzsh</code> is there a nice Plugin with some <code>kubectl</code> for more details check <a href=https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/kubectl target=_blank rel=noopener>ohmyzsh plugins kubectl</a></p><h2 id=install-minikube-with-ingress-controller>Install Minikube with Ingress Controller<a class=anchor aria-hidden=true href=#install-minikube-with-ingress-controller>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install minikube
</span></span></code></pre></div><h2 id=start-minikube>Start Minikube<a class=anchor aria-hidden=true href=#start-minikube>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube start
</span></span><span style=display:flex><span>😄  minikube v1.9.2 on Darwin 10.15.4
</span></span><span style=display:flex><span>    ▪ MINIKUBE_ACTIVE_DOCKERD<span style=color:#f92672>=</span>minikube
</span></span><span style=display:flex><span>✨  Using the hyperkit driver based on existing profile
</span></span><span style=display:flex><span>👍  Starting control plane node m01 in cluster minikube
</span></span><span style=display:flex><span>🔄  Restarting existing hyperkit VM <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#34;minikube&#34;</span> ...
</span></span><span style=display:flex><span>🐳  Preparing Kubernetes v1.18.0 on Docker 19.03.8 ...
</span></span><span style=display:flex><span>🌟  Enabling addons: dashboard, default-storageclass, ingress, storage-provisioner
</span></span><span style=display:flex><span>🏄  Done! kubectl is now configured to use <span style=color:#e6db74>&#34;minikube&#34;</span>
</span></span></code></pre></div><h2 id=minkikube-status>Minkikube Status<a class=anchor aria-hidden=true href=#minkikube-status>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube status
</span></span><span style=display:flex><span>m01
</span></span><span style=display:flex><span>host: Running
</span></span><span style=display:flex><span>kubelet: Running
</span></span><span style=display:flex><span>apiserver: Running
</span></span><span style=display:flex><span>kubeconfig: Configured
</span></span></code></pre></div><h2 id=enable-ingress-addons>Enable Ingress Addons<a class=anchor aria-hidden=true href=#enable-ingress-addons>#</a></h2><p>We need the addon <code>ingress</code> this can be done with the followng command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube addons enable ingress
</span></span></code></pre></div><p>Check minikube addons with <code>minikube addons list</code> if <code>ingress</code> is enabled.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube addons list
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>|-----------------------------|----------|--------------|
</span></span><span style=display:flex><span>|         ADDON NAME          | PROFILE  |    STATUS    |
</span></span><span style=display:flex><span>|-----------------------------|----------|--------------|
</span></span><span style=display:flex><span>| dashboard                   | minikube | enabled ✅   |
</span></span><span style=display:flex><span>| default-storageclass        | minikube | enabled ✅   |
</span></span><span style=display:flex><span>| efk                         | minikube | disabled     |
</span></span><span style=display:flex><span>| freshpod                    | minikube | disabled     |
</span></span><span style=display:flex><span>| gvisor                      | minikube | disabled     |
</span></span><span style=display:flex><span>| helm-tiller                 | minikube | disabled     |
</span></span><span style=display:flex><span>| ingress                     | minikube | enabled ✅   |
</span></span><span style=display:flex><span>| ingress-dns                 | minikube | disabled     |
</span></span><span style=display:flex><span>| istio                       | minikube | disabled     |
</span></span><span style=display:flex><span>| istio-provisioner           | minikube | disabled     |
</span></span><span style=display:flex><span>| logviewer                   | minikube | disabled     |
</span></span><span style=display:flex><span>| metrics-server              | minikube | disabled     |
</span></span><span style=display:flex><span>| nvidia-driver-installer     | minikube | disabled     |
</span></span><span style=display:flex><span>| nvidia-gpu-device-plugin    | minikube | disabled     |
</span></span><span style=display:flex><span>| registry                    | minikube | disabled     |
</span></span><span style=display:flex><span>| registry-aliases            | minikube | disabled     |
</span></span><span style=display:flex><span>| registry-creds              | minikube | disabled     |
</span></span><span style=display:flex><span>| storage-provisioner         | minikube | enabled ✅   |
</span></span><span style=display:flex><span>| storage-provisioner-gluster | minikube | disabled     |
</span></span><span style=display:flex><span>|-----------------------------|----------|--------------|
</span></span></code></pre></div><h2 id=ingress-controller>Ingress Controller<a class=anchor aria-hidden=true href=#ingress-controller>#</a></h2><p>Let&rsquo;s check if the <code>Nginx Ingress Controller</code> is up and running.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get pods -n kube-system | grep nginx-ingress
</span></span><span style=display:flex><span>nginx-ingress-controller-6d57c87cb9-rtgpk   1/1     Running   <span style=color:#ae81ff>1</span>          12m
</span></span></code></pre></div><h1 id=create-namespace>Create Namespace<a class=anchor aria-hidden=true href=#create-namespace>#</a></h1><p>Let&rsquo;s create first a <code>dev</code> name space where we deploy our sample application.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k create ns dev
</span></span><span style=display:flex><span>namespace/dev created
</span></span></code></pre></div><h1 id=switch-namespace-permanently>Switch Namespace Permanently<a class=anchor aria-hidden=true href=#switch-namespace-permanently>#</a></h1><p>With the following command we can switch the namespace permanently like <code>oc project</code> in a <code>OpenShift</code> environment.
This command will save the namespace for all other <code>kubectl</code> commands in that context.
This required the <a href=https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/kubectl target=_blank rel=noopener>ohmyzsh plugins kubectl</a> Plugin.
Without this plugin will be the command <code>kubectl config set-context --current --namespace=dev</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcn dev
</span></span></code></pre></div><h1 id=create-deployment>Create Deployment<a class=anchor aria-hidden=true href=#create-deployment>#</a></h1><p>Let&rsquo;s create a deployment now for a sample application with the name <code>myapp</code> with the image <code>google-samples/hello-app:1.0</code> in the current namespace <code>dev</code></p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k create deployment myapp --image<span style=color:#f92672>=</span>gcr.io/google-samples/hello-app:1.0
</span></span><span style=display:flex><span>deployment.apps/myapp created
</span></span></code></pre></div><p>If you want see what deployments we have you can use <code>kubectl get deployments</code> command.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get deployments
</span></span><span style=display:flex><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>myapp   1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           44m
</span></span></code></pre></div><p>Let&rsquo;s also check if the pod is running.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get pods -n dev -o wide --show-labels --field-selector<span style=color:#f92672>=</span>status.phase<span style=color:#f92672>=</span>Running
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                    READY   STATUS    RESTARTS   AGE   IP           NODE       NOMINATED NODE   READINESS GATES   LABELS
</span></span><span style=display:flex><span>myapp-75d86849b-2gbps   1/1     Running   <span style=color:#ae81ff>0</span>          67m   172.17.0.3   minikube   &lt;none&gt;           &lt;none&gt;            app<span style=color:#f92672>=</span>myapp,pod-template-hash<span style=color:#f92672>=</span>75d86849b
</span></span></code></pre></div><h1 id=create-service>Create Service<a class=anchor aria-hidden=true href=#create-service>#</a></h1><p>To reach our application we have to create a <code>service</code> this can be easily done with the <code>expose</code> command and the <code>NodePort</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k expose deployment myapp --port<span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span> --type<span style=color:#f92672>=</span>NodePort
</span></span></code></pre></div><p>Let&rsquo;s check the service.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get svc
</span></span><span style=display:flex><span>NAME    TYPE       CLUSTER-IP       EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>          AGE
</span></span><span style=display:flex><span>myapp   NodePort   10.110.101.126   &lt;none&gt;        8080:30506/TCP   21m
</span></span></code></pre></div><h2 id=test-service-internal-in-a-cluster>Test Service internal in a Cluster<a class=anchor aria-hidden=true href=#test-service-internal-in-a-cluster>#</a></h2><p>Let&rsquo;s check the service with a small container based on the <code>tutum/curl:alpine</code> Docker image, which contains the curl command.
Run the <code>curl -s 'http://myapp:8080'</code> command inside the container and redirect the output to the Terminal using the <code>-i</code> option.
Delete the pod using the <code>--rm</code> option.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k run -i --rm --restart<span style=color:#f92672>=</span>Never curl-client --image<span style=color:#f92672>=</span>tutum/curl:alpine --command -- curl -s <span style=color:#e6db74>&#39;http://myapp:8080&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 1.0.0
</span></span><span style=display:flex><span>Hostname: myapp-75d86849b-2gbps
</span></span><span style=display:flex><span>pod <span style=color:#e6db74>&#34;curl-client&#34;</span> deleted
</span></span></code></pre></div><p>This mean we can call a pod internal a cluster with the internal <code>DNS</code>.</p><h2 id=test-service-outside-a-cluster>Test Service outside a Cluster<a class=anchor aria-hidden=true href=#test-service-outside-a-cluster>#</a></h2><p>Let&rsquo;s call again the command <code>k get svc</code> to get the exposed port from out service.
Run the following command again :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get svc
</span></span><span style=display:flex><span>NAME    TYPE       CLUSTER-IP       EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>          AGE
</span></span><span style=display:flex><span>myapp   NodePort   10.110.101.126   &lt;none&gt;        8080:30506/TCP   21m
</span></span></code></pre></div><p>You see the exposed port is here <code>30506</code> now let&rsquo;s get the <code>IP</code> address from out minikube with <code>minikube ip</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube ip
</span></span><span style=display:flex><span>192.168.64.18
</span></span></code></pre></div><p>Now let&rsquo;s also call out service <code>myapp</code> with <code>HTTPie</code> or in a browser <code>http://192.168.64.18:30506</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http http://192.168.64.18:30506
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>61</span>
</span></span><span style=display:flex><span>Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Date: Sun, <span style=color:#ae81ff>03</span> May <span style=color:#ae81ff>2020</span> 08:07:35 GMT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 1.0.0
</span></span><span style=display:flex><span>Hostname: myapp-75d86849b-2gbps
</span></span></code></pre></div><h1 id=etchosts>/etc/hosts<a class=anchor aria-hidden=true href=#etchosts>#</a></h1><p>To get on the service with the URL <code>minikube.me</code> we update now out local <code>/etc/hosts</code> file with <code>IP</code> address from your minikube <code>minikube ip</code>
Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#66d9ef>$(</span>minikube ip<span style=color:#66d9ef>)</span> minikube.me | sudo tee -a /etc/hosts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Password:
</span></span><span style=display:flex><span>192.168.64.11 minikube.me
</span></span></code></pre></div><p>Verify it the <code>IP</code> is in the <code>/etc/hosts</code> with the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /etc/hosts | tail -n <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>192.168.64.11 minikube.me
</span></span></code></pre></div><p>Now you can also call the service wit the <code>DNS</code> <code>http://minikube.me:30506</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http http://minikube.me:30506
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>61</span>
</span></span><span style=display:flex><span>Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Date: Sun, <span style=color:#ae81ff>03</span> May <span style=color:#ae81ff>2020</span> 08:12:51 GMT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 1.0.0
</span></span><span style=display:flex><span>Hostname: myapp-75d86849b-2gbps
</span></span></code></pre></div><h1 id=nginx-ingress>Nginx Ingress<a class=anchor aria-hidden=true href=#nginx-ingress>#</a></h1><p>Now is time to create our <code>nginx ingress</code> for this we creat a file named <code>nginx-ingess.yaml</code>
where we point <code>/</code> to the <code>myapp</code> service on internal port <code>8080</code>.</p><p>Run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo  <span style=color:#e6db74>&#34;apiVersion: networking.k8s.io/v1beta1 # for versions before 1.14 use extensions/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Ingress
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74> name: nginx-ingress
</span></span></span><span style=display:flex><span><span style=color:#e6db74> namespace: dev
</span></span></span><span style=display:flex><span><span style=color:#e6db74> annotations:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   nginx.ingress.kubernetes.io/rewrite-target: /</span>$1<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74> rules:
</span></span></span><span style=display:flex><span><span style=color:#e6db74> - host: minikube.me
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   http:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     paths:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>     - path: /
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       backend:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         serviceName: myapp
</span></span></span><span style=display:flex><span><span style=color:#e6db74>         servicePort: 8080&#34;</span>  | &gt; nginx-ingess.yaml
</span></span></code></pre></div><p>Now let&rsquo;s also take a new <code>alias</code> in the game <code>kaf</code> is the alias for <code>kubectl -f</code> and let&rsquo;s apply the <code>nginx-ingess.yaml</code> file.
For this run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kaf nginx-ingess.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ingress.networking.k8s.io/nginx-ingress created
</span></span></code></pre></div><p>With <code>kubectl get ingress</code> you can list all ingress in the namespace.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get ingress
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME            CLASS    HOSTS         ADDRESS   PORTS   AGE
</span></span><span style=display:flex><span>nginx-ingress   &lt;none&gt;   minikube.me             <span style=color:#ae81ff>80</span>      22s
</span></span></code></pre></div><h2 id=test-ingress>Test Ingress<a class=anchor aria-hidden=true href=#test-ingress>#</a></h2><p>Open a browser now <code>http://minikube.me</code> or with <code>HTTPie</code> in a terminal.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http http://minikube.me
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Connection: keep-alive
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>61</span>
</span></span><span style=display:flex><span>Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Date: Sun, <span style=color:#ae81ff>03</span> May <span style=color:#ae81ff>2020</span> 09:18:45 GMT
</span></span><span style=display:flex><span>Server: openresty/1.15.8.2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 1.0.0
</span></span><span style=display:flex><span>Hostname: myapp-75d86849b-v72vs
</span></span></code></pre></div><p>Now let&rsquo;s also deploy a second application and expose it as service.
Configure the <code>nginx ingress</code> also to the second service.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k create deployment myapp2 --image<span style=color:#f92672>=</span>gcr.io/google-samples/hello-app:2.0
</span></span><span style=display:flex><span>k expose deployment myapp2 --port<span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span> --type<span style=color:#f92672>=</span>NodePort
</span></span></code></pre></div><p>Update the <code>nginx-ingess.yaml</code> file with <code>vi</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/v2/*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>serviceName</span>: <span style=color:#ae81ff>myapp2</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>servicePort</span>: <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><p>Check the <code>nginx-ingess.yaml</code> file with <code>cat nginx-ingess.yaml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apiVersion: networking.k8s.io/v1beta1 <span style=color:#75715e># for versions before 1.14 use extensions/v1beta1</span>
</span></span><span style=display:flex><span>kind: Ingress
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span> name: nginx-ingress
</span></span><span style=display:flex><span> namespace: dev
</span></span><span style=display:flex><span> annotations:
</span></span><span style=display:flex><span>   nginx.ingress.kubernetes.io/rewrite-target: /
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span> rules:
</span></span><span style=display:flex><span> - host: minikube.me
</span></span><span style=display:flex><span>   http:
</span></span><span style=display:flex><span>     paths:
</span></span><span style=display:flex><span>     - path: /
</span></span><span style=display:flex><span>       backend:
</span></span><span style=display:flex><span>         serviceName: myapp
</span></span><span style=display:flex><span>         servicePort: <span style=color:#ae81ff>8080</span>     
</span></span><span style=display:flex><span>     - path: /v2
</span></span><span style=display:flex><span>       backend:
</span></span><span style=display:flex><span>         serviceName: myapp2
</span></span><span style=display:flex><span>         servicePort: <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><p>Apply the changes with the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kaf nginx-ingess.yaml
</span></span><span style=display:flex><span>ingress.networking.k8s.io/nginx-ingress configured
</span></span></code></pre></div><p>Now we have one Ingress who point to 2 individual services.
Verify it with <code>HTTPie</code> or with the browser <code>http://minikube.me/</code> will give back <code>Version: 1.0.0</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http http://minikube.me/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Connection: keep-alive
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>61</span>
</span></span><span style=display:flex><span>Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Date: Sun, <span style=color:#ae81ff>03</span> May <span style=color:#ae81ff>2020</span> 09:31:12 GMT
</span></span><span style=display:flex><span>Server: openresty/1.15.8.2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 1.0.0
</span></span><span style=display:flex><span>Hostname: myapp-75d86849b-v72vs
</span></span></code></pre></div><p>On the second route <code>http://minikube.me/v2</code> we get back <code>Version: 2.0.0</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>http http://minikube.me/v2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Connection: keep-alive
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>63</span>
</span></span><span style=display:flex><span>Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Date: Sun, <span style=color:#ae81ff>03</span> May <span style=color:#ae81ff>2020</span> 09:32:23 GMT
</span></span><span style=display:flex><span>Server: openresty/1.15.8.2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello, world!
</span></span><span style=display:flex><span>Version: 2.0.0
</span></span><span style=display:flex><span>Hostname: myapp2-548b98644f-rqqmp
</span></span></code></pre></div><h1 id=kubectl-cheat-sheet>kubectl Cheat Sheet<a class=anchor aria-hidden=true href=#kubectl-cheat-sheet>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get pods -o wide --show-labels  --field-selector<span style=color:#f92672>=</span>status.phase<span style=color:#f92672>=</span>Running  -w   | grep -vi <span style=color:#e6db74>&#34;Terminating&#34;</span>
</span></span><span style=display:flex><span>NAME                   READY   STATUS    RESTARTS   AGE   IP           NODE       NOMINATED NODE   READINESS GATES   LABELS
</span></span><span style=display:flex><span>web-6785d44d5-vb2wb    1/1     Running   <span style=color:#ae81ff>1</span>          19h   172.17.0.4   minikube   &lt;none&gt;           &lt;none&gt;            app<span style=color:#f92672>=</span>web,pod-template-hash<span style=color:#f92672>=</span>6785d44d5
</span></span><span style=display:flex><span>web2                   1/1     Running   <span style=color:#ae81ff>1</span>          19h   172.17.0.3   minikube   &lt;none&gt;           &lt;none&gt;            run<span style=color:#f92672>=</span>web2
</span></span><span style=display:flex><span>web2-8474c56fd-wk4kh   1/1     Running   <span style=color:#ae81ff>1</span>          18h   172.17.0.5   minikube   &lt;none&gt;           &lt;none&gt;            app<span style=color:#f92672>=</span>web2,pod-template-hash<span style=color:#f92672>=</span>8474c56fd
</span></span></code></pre></div><h2 id=namespaces>Namespaces<a class=anchor aria-hidden=true href=#namespaces>#</a></h2><ul><li><code>kubectl get ns</code></li><li><code>k get ns</code></li><li><code>kgns</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k get ns
</span></span><span style=display:flex><span>NAME              STATUS   AGE
</span></span><span style=display:flex><span>default           Active   19h
</span></span><span style=display:flex><span>kube-node-lease   Active   19h
</span></span><span style=display:flex><span>kube-public       Active   19h
</span></span><span style=display:flex><span>kube-system       Active   19h
</span></span></code></pre></div><h2 id=delete-with-given-label>Delete with given label<a class=anchor aria-hidden=true href=#delete-with-given-label>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>k delete all -l  app<span style=color:#f92672>=</span>web
</span></span></code></pre></div><h2 id=troubleshooting>Troubleshooting<a class=anchor aria-hidden=true href=#troubleshooting>#</a></h2><pre tabindex=0><code>sudo dscacheutil -flushcache;sudo killall -HUP mDNSResponder
</code></pre><hr><p><em>References:</em></p><blockquote><p><a href=https://kubernetes.io/docs/tasks/access-application-cluster/ingress-minikube/ target=_blank rel=noopener>ingress-minikube</a></p></blockquote></div><div class=share-buttons></div></div><aside><article><h3>See Also</h3><a href=/blog/2019/2019-10-22-axon/><hgroup><h4><i>AxonIQ</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-08-28-multiple-project-promoting/><hgroup><h4><i>Promoting Applications Across Environments</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-09-18-spring-boot-k8s-configmap/><hgroup><h4><i>Spring Boot Kubernetes ConfigMap</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-09-21-spring-boot-k8s-ribbon-discovery/><hgroup><h4><i>Spring Boot Kubernetes Discovery</i></h4><p><time datetime='2019-09-18 00:00:00 +0000 UTC'>September 18, 2019</time>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a><a href=/blog/2019/2019-09-08-semantic-release-delivery-pipeline/><hgroup><h4><i>Semantic Release Delivery Pipeline</i></h4><p><time datetime='2019-09-08 00:00:00 +0000 UTC'>September 8, 2019</time>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Marcel Widmer</p></hgroup></a></article></aside></div></div></main><footer class=text-center><span>&copy; 2022 <a href=https://blog.marcelwidmer.org>c3smonkey's blog</a></span><div><a href=https://blog.marcelwidmer.org/legal/privacy>Privacy Policy</a>
<span>&</span>
<a href=https://blog.marcelwidmer.org/legal/terms-and-conditions>Terms and Conditions</a></div></footer><article class=hidden id=cookie-banner><div><span></span></div><footer><a role=button id=consent-cookies>Close</a>
<a role=button class=secondary href=/></a></footer></article><script async src=https://blog.marcelwidmer.org/js/cookie.min.js layout=container></script>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("kbd");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=https://blog.marcelwidmer.org/plugins/js/feather.min.js layout=container></script>
<script src=https://blog.marcelwidmer.org/js/script.min.js layout=container></script></body></html>