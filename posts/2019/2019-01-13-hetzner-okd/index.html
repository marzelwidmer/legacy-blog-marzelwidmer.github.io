<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) # Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name &lt;YOUR_DOMAIN&gt; --type &lt;SERVER-TYPE&gt; --image &lt;IMAGE&gt; --ssh-key &lt;YOUR_HETZNER_SSH_KEY&gt; --datacenter &lt;DATACENTER&gt; Server Type # hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Install OKD on Hetzner Cloud" />
<meta property="og:description" content="Inspiration from Installation of OKD 3.10 from start to finish
Create a Hetzner VM with the CLI https://github.com/hetznercloud/cli
hcloud (Hetzner CLI) # Let&rsquo;s check first some hcloud command that we can use later to create a VM with the right size and in the Datacenter we want.
hcloud server create --name &lt;YOUR_DOMAIN&gt; --type &lt;SERVER-TYPE&gt; --image &lt;IMAGE&gt; --ssh-key &lt;YOUR_HETZNER_SSH_KEY&gt; --datacenter &lt;DATACENTER&gt; Server Type # hcloud server-type list ID NAME CORES MEMORY DISK STORAGE TYPE 1 cx11 1 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019/2019-01-13-hetzner-okd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-09-25T16:26:41+02:00" />

<title>Install OKD on Hetzner Cloud | Blog Marcel Widmer </title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css" >
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.6d9040acb89aff39f832a0b8623fad42fa664a32ef333ca95112d6156a809515.js" ></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/avatar.png" alt="Logo" /><span>Blog Marcel Widmer </span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>



  



  
    
  



<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/de/">
          Deutsch
        </a>
      </li>
      
    </ul>
  </li>
</ul>











  












  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Install OKD on Hetzner Cloud</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#hcloud-hetzner-cli">hcloud (Hetzner CLI)</a>
      <ul>
        <li><a href="#server-type">Server Type</a></li>
        <li><a href="#image">Image</a></li>
        <li><a href="#datacenter">Datacenter</a></li>
        <li><a href="#create-server">Create Server</a>
          <ul>
            <li><a href="#rebuild-server">Rebuild Server</a></li>
            <li><a href="#delete-server">Delete Server</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#configure-dns">Configure DNS</a></li>
    <li><a href="#install-okd">Install OKD</a>
      <ul>
        <li><a href="#update-system-and-install-git">Update System and install GIT</a></li>
        <li><a href="#clone-git-repo">Clone Git Repo</a></li>
        <li><a href="#update-user-custom-exports-script">Update user-custom-exports script</a></li>
        <li><a href="#load-user-custom-exports-script">Load user-custom-exports script</a></li>
        <li><a href="#start-install-script">Start install script</a></li>
      </ul>
    </li>
    <li><a href="#renewal-lets-encrypt">Renewal Let&rsquo;s Encrypt</a>
      <ul>
        <li><a href="#check-certificate">Check Certificate</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown">
  <h1>
    <a href="/posts/2019/2019-01-13-hetzner-okd/">Install OKD on Hetzner Cloud</a>
  </h1>
  
  <h5>January 13, 2019</h5>



  

  
  <div>
    
      <a href="/tags/k8s/">k8s</a>, 
      <a href="/tags/OKD/">OKD</a>, 
      <a href="/tags/Hetzner-Cloud/">Hetzner Cloud</a>
  </div>
  



<p>Inspiration from 
  <a href="https://www.youtube.com/watch?v=ZkFIozGY0IA">Installation of OKD 3.10 from start to finish</a></p>
<p>Create a <code>Hetzner VM</code> with the CLI 
  <a href="https://github.com/hetznercloud/cli">https://github.com/hetznercloud/cli</a></p>
<h1 id="hcloud-hetzner-cli">
  hcloud (Hetzner CLI)
  <a class="anchor" href="#hcloud-hetzner-cli">#</a>
</h1>
<p>Let&rsquo;s check first some <code>hcloud</code> command that we can use later to create a <code>VM</code> with the right size and in the <code>Datacenter</code> we want.</p>
<p>
  <img src="/static/hetzner/hetzner-preis.png" alt="hetzner-preis" /></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud server create --name &lt;YOUR_DOMAIN&gt; --type &lt;SERVER-TYPE&gt; --image &lt;IMAGE&gt; --ssh-key &lt;YOUR_HETZNER_SSH_KEY&gt; --datacenter &lt;DATACENTER&gt;
</span></span></code></pre></div><h2 id="server-type">
  Server Type
  <a class="anchor" href="#server-type">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud server-type list
</span></span><span style="display:flex;"><span>ID   NAME        CORES   MEMORY     DISK     STORAGE TYPE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>    cx11        <span style="color:#ae81ff">1</span>       2.0 GB     <span style="color:#ae81ff">20</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    cx11-ceph   <span style="color:#ae81ff">1</span>       2.0 GB     <span style="color:#ae81ff">20</span> GB    network
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    cx21        <span style="color:#ae81ff">2</span>       4.0 GB     <span style="color:#ae81ff">40</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    cx21-ceph   <span style="color:#ae81ff">2</span>       4.0 GB     <span style="color:#ae81ff">40</span> GB    network
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>    cx31        <span style="color:#ae81ff">2</span>       8.0 GB     <span style="color:#ae81ff">80</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>    cx31-ceph   <span style="color:#ae81ff">2</span>       8.0 GB     <span style="color:#ae81ff">80</span> GB    network
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>    cx41        <span style="color:#ae81ff">4</span>       16.0 GB    <span style="color:#ae81ff">160</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>    cx41-ceph   <span style="color:#ae81ff">4</span>       16.0 GB    <span style="color:#ae81ff">160</span> GB   network
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>    cx51        <span style="color:#ae81ff">8</span>       32.0 GB    <span style="color:#ae81ff">240</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>   cx51-ceph   <span style="color:#ae81ff">8</span>       32.0 GB    <span style="color:#ae81ff">240</span> GB   network
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>   ccx11       <span style="color:#ae81ff">2</span>       8.0 GB     <span style="color:#ae81ff">80</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>   ccx21       <span style="color:#ae81ff">4</span>       16.0 GB    <span style="color:#ae81ff">160</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>   ccx31       <span style="color:#ae81ff">8</span>       32.0 GB    <span style="color:#ae81ff">240</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span>   ccx41       <span style="color:#ae81ff">16</span>      64.0 GB    <span style="color:#ae81ff">360</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>   ccx51       <span style="color:#ae81ff">32</span>      128.0 GB   <span style="color:#ae81ff">600</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">22</span>   cpx11       <span style="color:#ae81ff">2</span>       2.0 GB     <span style="color:#ae81ff">40</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">23</span>   cpx21       <span style="color:#ae81ff">3</span>       4.0 GB     <span style="color:#ae81ff">80</span> GB    local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">24</span>   cpx31       <span style="color:#ae81ff">4</span>       8.0 GB     <span style="color:#ae81ff">160</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">25</span>   cpx41       <span style="color:#ae81ff">8</span>       16.0 GB    <span style="color:#ae81ff">240</span> GB   local
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">26</span>   cpx51       <span style="color:#ae81ff">16</span>      32.0 GB    <span style="color:#ae81ff">360</span> GB   local
</span></span></code></pre></div><h2 id="image">
  Image
  <a class="anchor" href="#image">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud image list
</span></span><span style="display:flex;"><span>ID         TYPE     NAME           DESCRIPTION    IMAGE SIZE   DISK SIZE   CREATED
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>          system   ubuntu-16.04   Ubuntu 16.04   -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">2</span> years ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          system   debian-9       Debian <span style="color:#ae81ff">9</span>       -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">2</span> years ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>          system   centos-7       CentOS <span style="color:#ae81ff">7</span>       -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">2</span> years ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">168855</span>     system   ubuntu-18.04   Ubuntu 18.04   -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">2</span> years ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5924233</span>    system   debian-10      Debian <span style="color:#ae81ff">10</span>      -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">9</span> months ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8356453</span>    system   centos-8       CentOS <span style="color:#ae81ff">8</span>       -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">6</span> months ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9032843</span>    system   fedora-31      Fedora <span style="color:#ae81ff">31</span>      -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">5</span> months ago
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15512617</span>   system   ubuntu-20.04   Ubuntu 20.04   -            <span style="color:#ae81ff">5</span> GB        <span style="color:#ae81ff">2</span> days ago
</span></span></code></pre></div><h2 id="datacenter">
  Datacenter
  <a class="anchor" href="#datacenter">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud datacenter list
</span></span><span style="display:flex;"><span>ID   NAME        DESCRIPTION          LOCATION
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>    nbg1-dc3    Nuremberg <span style="color:#ae81ff">1</span> DC <span style="color:#ae81ff">3</span>     nbg1
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    hel1-dc2    Helsinki <span style="color:#ae81ff">1</span> DC <span style="color:#ae81ff">2</span>      hel1
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    fsn1-dc14   Falkenstein <span style="color:#ae81ff">1</span> DC14   fsn1
</span></span></code></pre></div><h2 id="create-server">
  Create Server
  <a class="anchor" href="#create-server">#</a>
</h2>
<p>Let&rsquo;s create a Server <code>cx41</code> with CentOS <code>centos-7</code> (because of some issues with <code>centos-8</code>) on a data center in Nuremberg <code>nbg1-dc3</code>.
When the Server is we will get a Public IP <code>116.203.16.100</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud server create --name keepcalm.ch --type cx41 --image centos-8 --ssh-key ~/.ssh/id_rsa_hetzner.pub --datacenter nbg1-dc3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>6s <span style="color:#f92672">[=====================================]</span> 100.00%
</span></span><span style="display:flex;"><span>Waiting <span style="color:#66d9ef">for</span> server <span style="color:#ae81ff">5577861</span> to have started
</span></span><span style="display:flex;"><span> ... <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>Server <span style="color:#ae81ff">5577861</span> created
</span></span><span style="display:flex;"><span>IPv4: 116.203.16.100
</span></span></code></pre></div><h3 id="rebuild-server">
  Rebuild Server
  <a class="anchor" href="#rebuild-server">#</a>
</h3>
<p>if you have already one and want it just rest and re-install the cluster you can user the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud server rebuild keepcalm.ch --image centos-7
</span></span></code></pre></div><h3 id="delete-server">
  Delete Server
  <a class="anchor" href="#delete-server">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hcloud server delete keepcalm.ch
</span></span></code></pre></div><h1 id="configure-dns">
  Configure DNS
  <a class="anchor" href="#configure-dns">#</a>
</h1>
<p>Configure now the following <code>DNS</code> entries in your <code>DNS</code> provider with the <code>IP</code> from <code>Hetzner</code> in my case I have 
  <a href="https://www.gandi.net/en">gandi.net</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1585063961 10800 3600 604800 10800
</span></span><span style="display:flex;"><span>* 420 IN CNAME apps.console
</span></span><span style="display:flex;"><span>@ 1800 IN A 116.203.16.100
</span></span><span style="display:flex;"><span>apps.console 300 IN A 116.203.16.100
</span></span><span style="display:flex;"><span>console 300 IN A 116.203.16.100
</span></span></code></pre></div><h1 id="install-okd">
  Install OKD
  <a class="anchor" href="#install-okd">#</a>
</h1>
<p>Now you can connect with <code>SSH</code> to your <code>VM</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh -i ~/.ssh/id_rsa_hetzner root@keepcalm.ch
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;keepcalm.ch (116.203.16.100)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:mc7itrGp4777okbKnKDKPDlQwkMi0e4awyh6cfssNXM.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warning: Permanently added &#39;</span>keepcalm.ch,116.203.16.100<span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span> to the list of known hosts.
</span></span><span style="display:flex;"><span>Last failed login: Sun Apr <span style="color:#ae81ff">26</span> 12:02:57 CEST <span style="color:#ae81ff">2020</span> from 51.77.212.235 on ssh:notty
</span></span><span style="display:flex;"><span>There were <span style="color:#ae81ff">3</span> failed login attempts since the last successful login.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@keepcalm ~<span style="color:#f92672">]</span><span style="color:#75715e">#</span>
</span></span></code></pre></div><h2 id="update-system-and-install-git">
  Update System and install GIT
  <a class="anchor" href="#update-system-and-install-git">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yum -y update <span style="color:#f92672">&amp;&amp;</span> yum -y install git
</span></span></code></pre></div><h2 id="clone-git-repo">
  Clone Git Repo
  <a class="anchor" href="#clone-git-repo">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/marzelwidmer/installcentos.git
</span></span></code></pre></div><h2 id="update-user-custom-exports-script">
  Update user-custom-exports script
  <a class="anchor" href="#update-user-custom-exports-script">#</a>
</h2>
<p>Update <code>user-custom-exports.sh</code> script with your domain specific settings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd installcentos <span style="color:#f92672">&amp;&amp;</span> vi user-custom-exports.sh
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>#!/bin/bash
</span></span><span style="display:flex;"><span>export DOMAIN=&#34;keepcalm.ch&#34;
</span></span><span style="display:flex;"><span>export USERNAME=&#34;admin&#34;
</span></span><span style="display:flex;"><span>export PASSWORD=&#34;password&#34;
</span></span><span style="display:flex;"><span>export MAIL=&#34;marzelwidmer@gmail.com&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>export SCRIPT_REPO=&#34;&#34;
</span></span><span style="display:flex;"><span>export IP=&#34;&#34;
</span></span><span style="display:flex;"><span>export DISK=&#34;&#34;
</span></span></code></pre></div><h2 id="load-user-custom-exports-script">
  Load user-custom-exports script
  <a class="anchor" href="#load-user-custom-exports-script">#</a>
</h2>
<p>Execute the shell script to load the variables</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>. user-custom-exports.sh
</span></span></code></pre></div><h2 id="start-install-script">
  Start install script
  <a class="anchor" href="#start-install-script">#</a>
</h2>
<p>Now we can execute the installation script and press enter till the question <code>Do you wish to enable HTTPS with Let``s Encrypt</code>
There we choose <code>1) Yes</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@keepcalm installcentos<span style="color:#f92672">]</span><span style="color:#75715e"># ./install-openshift.sh</span>
</span></span><span style="display:flex;"><span>Domain to use: <span style="color:#f92672">(</span>keepcalm.ch<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>Username: <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>Password: <span style="color:#f92672">(</span>password<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>OpenShift Version: <span style="color:#f92672">(</span>3.11<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>IP: <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>API Port: <span style="color:#f92672">(</span>8443<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>Do you wish to enable HTTPS with Let<span style="color:#e6db74">&#39;s Encrypt?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warnings:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Let&#39;</span>s Encrypt only works <span style="color:#66d9ef">if</span> the IP is using publicly accessible IP and custom certificates.
</span></span><span style="display:flex;"><span>  This feature doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t work with OpenShift CLI <span style="color:#66d9ef">for</span> now.
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> Yes
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> No
</span></span></code></pre></div><p>The following questions we answer with yes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Complete!
</span></span><span style="display:flex;"><span>Saving debug log to /var/log/letsencrypt/letsencrypt.log
</span></span><span style="display:flex;"><span>Plugins selected: Authenticator manual, Installer None
</span></span><span style="display:flex;"><span>Starting new HTTPS connection <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>: acme-v02.api.letsencrypt.org
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>Would you be willing to share your email address with the Electronic Frontier
</span></span><span style="display:flex;"><span>Foundation, a founding partner of the Let<span style="color:#e6db74">&#39;s Encrypt project and the non-profit
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">organization that develops Certbot? We&#39;</span>d like to send you email about our work
</span></span><span style="display:flex;"><span>encrypting the web, EFF news, campaigns, and ways to support digital freedom.
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>Y<span style="color:#f92672">)</span>es/<span style="color:#f92672">(</span>N<span style="color:#f92672">)</span>o: yes
</span></span><span style="display:flex;"><span>Starting new HTTPS connection <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>: supporters.eff.org
</span></span><span style="display:flex;"><span>Obtaining a new certificate
</span></span><span style="display:flex;"><span>Performing the following challenges:
</span></span><span style="display:flex;"><span>dns-01 challenge <span style="color:#66d9ef">for</span> apps.keepcalm.ch
</span></span><span style="display:flex;"><span>dns-01 challenge <span style="color:#66d9ef">for</span> keepcalm.ch
</span></span><span style="display:flex;"><span>dns-01 challenge <span style="color:#66d9ef">for</span> keepcalm.ch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>NOTE: The IP of this machine will be publicly logged as having requested this
</span></span><span style="display:flex;"><span>certificate. If you<span style="color:#e6db74">&#39;re running certbot in manual mode on a machine that is not
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">your server, please ensure you&#39;</span>re okay with that.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Are you OK with your IP being logged?
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>Y<span style="color:#f92672">)</span>es/<span style="color:#f92672">(</span>N<span style="color:#f92672">)</span>o: yes
</span></span></code></pre></div><blockquote>
<p>⚠️ <strong>Important Steps</strong>: Be sure you update the <code>DNS TXT</code> records with the prompted values</p>
</blockquote>
<p>The following values you have to add in you <code>DNS</code>.
So let&rsquo;s open again the <code>DNS</code> Admin console from your provider.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>Please deploy a DNS TXT record under the name
</span></span><span style="display:flex;"><span>_acme-challenge.apps.keepcalm.ch with the following value:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Before continuing, verify the record is deployed.
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>Press Enter to Continue
</span></span></code></pre></div><p>In my case something like so :</p>
<p>
  <img src="/static/hetzner/acme.png" alt="acme" /></p>
<p>You can check the <code>DNS</code> with 
  <a href="https://dnschecker.org/#TXT/_acme-challenge.apps.keepcalm.ch">https://dnschecker.org/</a>
Check with <code>host</code> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>host -t txt _acme-challenge.apps.keepcalm.ch
</span></span><span style="display:flex;"><span>_acme-challenge.apps.keepcalm.ch descriptive text <span style="color:#e6db74">&#34;xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI&#34;</span>
</span></span></code></pre></div><p>Your <code>DNS</code> will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>@ 10800 IN SOA ns1.gandi.net. hostmaster.gandi.net. 1587897751 10800 3600 604800 10800
</span></span><span style="display:flex;"><span>* 420 IN CNAME apps.console
</span></span><span style="display:flex;"><span>@ 1800 IN A 116.203.16.100
</span></span><span style="display:flex;"><span>_acme-challenge 300 IN TXT &#34;H2S720yowtzUBVKq3EbH6W8rmgg7qzF0EEVF_IZOz9c&#34;
</span></span><span style="display:flex;"><span>_acme-challenge 300 IN TXT &#34;dpMeonbQDeHkbJopDOuXw1j4NtFHXzEvr8CGutiRX8w&#34;
</span></span><span style="display:flex;"><span>_acme-challenge.apps 300 IN TXT &#34;xj9uF017asqGXhuS1VPhA3idwmUq__UgUTscTMYgbxI&#34;
</span></span><span style="display:flex;"><span>apps.console 300 IN A 116.203.16.100
</span></span><span style="display:flex;"><span>console 300 IN A 116.203.16.100
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Before continuing, verify the record is deployed.
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>This must be set up in addition to the previous challenges; <span style="color:#66d9ef">do</span> not remove,
</span></span><span style="display:flex;"><span>replace, or undo the previous challenge tasks yet. Note that you might be
</span></span><span style="display:flex;"><span>asked to create multiple distinct TXT records with the same name. This is
</span></span><span style="display:flex;"><span>permitted by DNS standards.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>Press Enter to Continue
</span></span><span style="display:flex;"><span>Waiting <span style="color:#66d9ef">for</span> verification...
</span></span><span style="display:flex;"><span>Resetting dropped connection: acme-v02.api.letsencrypt.org
</span></span><span style="display:flex;"><span>Cleaning up challenges
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>IMPORTANT NOTES:
</span></span><span style="display:flex;"><span> - Congratulations! Your certificate and chain have been saved at:
</span></span><span style="display:flex;"><span>   /etc/letsencrypt/live/keepcalm.ch/fullchain.pem
</span></span><span style="display:flex;"><span>   Your key file has been saved at:
</span></span><span style="display:flex;"><span>   /etc/letsencrypt/live/keepcalm.ch/privkey.pem
</span></span><span style="display:flex;"><span>   Your cert will expire on 2020-07-25. To obtain a new or tweaked
</span></span><span style="display:flex;"><span>   version of this certificate in the future, simply run certbot
</span></span><span style="display:flex;"><span>   again. To non-interactively renew *all* of your certificates, run
</span></span><span style="display:flex;"><span>   <span style="color:#e6db74">&#34;certbot renew&#34;</span>
</span></span><span style="display:flex;"><span> - Your account credentials have been saved in your Certbot
</span></span><span style="display:flex;"><span>   configuration directory at /etc/letsencrypt. You should make a
</span></span><span style="display:flex;"><span>   secure backup of this folder now. This configuration directory will
</span></span><span style="display:flex;"><span>   also contain certificates and private keys obtained by Certbot so
</span></span><span style="display:flex;"><span>   making regular backups of this folder is ideal.
</span></span><span style="display:flex;"><span> - If you like Certbot, please consider supporting our work by:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   Donating to ISRG / Let<span style="color:#960050;background-color:#1e0010">&#39;</span>s Encrypt:   https://letsencrypt.org/donate
</span></span><span style="display:flex;"><span>   Donating to EFF:                    https://eff.org/donate-le
</span></span></code></pre></div><p>Now you have to wait some minutes till the installation is finished.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>created volume <span style="color:#ae81ff">199</span>
</span></span><span style="display:flex;"><span>persistentvolume/vol200 created
</span></span><span style="display:flex;"><span>created volume <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>******
</span></span><span style="display:flex;"><span>* Your console is https://console.keepcalm.ch:8443
</span></span><span style="display:flex;"><span>* Your username is admin
</span></span><span style="display:flex;"><span>* Your password is password
</span></span><span style="display:flex;"><span>*
</span></span><span style="display:flex;"><span>* Login using:
</span></span><span style="display:flex;"><span>*
</span></span><span style="display:flex;"><span>$ oc login -u admin -p password https://console.keepcalm.ch:8443/
</span></span><span style="display:flex;"><span>******
</span></span><span style="display:flex;"><span>Login successful.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You have access to the following projects and can switch between them with <span style="color:#e6db74">&#39;oc project &lt;projectname&gt;&#39;</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  * default
</span></span><span style="display:flex;"><span>    kube-public
</span></span><span style="display:flex;"><span>    kube-service-catalog
</span></span><span style="display:flex;"><span>    kube-system
</span></span><span style="display:flex;"><span>    management-infra
</span></span><span style="display:flex;"><span>    openshift
</span></span><span style="display:flex;"><span>    openshift-console
</span></span><span style="display:flex;"><span>    openshift-infra
</span></span><span style="display:flex;"><span>    openshift-logging
</span></span><span style="display:flex;"><span>    openshift-metrics-server
</span></span><span style="display:flex;"><span>    openshift-monitoring
</span></span><span style="display:flex;"><span>    openshift-node
</span></span><span style="display:flex;"><span>    openshift-sdn
</span></span><span style="display:flex;"><span>    openshift-template-service-broker
</span></span><span style="display:flex;"><span>    openshift-web-console
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Using project <span style="color:#e6db74">&#34;default&#34;</span>.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@keepcalm installcentos<span style="color:#f92672">]</span><span style="color:#75715e">#</span>
</span></span></code></pre></div><p>After the installation is finish you can on : 
  <a href="https://console.keepcalm.ch:8443/console/catalog">https://console.keepcalm.ch:8443/console/catalog</a>
You have now a <code>OKD</code> instance with Let&rsquo;s Encrypt.</p>
<p>
  <img src="/static/hetzner//console.png" alt="hetzner-preis" /></p>
<h1 id="renewal-lets-encrypt">
  Renewal Let&rsquo;s Encrypt
  <a class="anchor" href="#renewal-lets-encrypt">#</a>
</h1>
<p>There is a <code>crontab</code> with renew command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>crontab -l
</span></span><span style="display:flex;"><span>@weekly  certbot renew --pre-hook<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;oc scale --replicas=0 dc router&#34;</span> --post-hook<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;oc scale --replicas=1 dc router&#34;</span>
</span></span></code></pre></div><h2 id="check-certificate">
  Check Certificate
  <a class="anchor" href="#check-certificate">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>certbot certificates
</span></span><span style="display:flex;"><span>Saving debug log to /var/log/letsencrypt/letsencrypt.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span style="display:flex;"><span>Found the following certs:
</span></span><span style="display:flex;"><span>  Certificate Name: c3smonkey.ch
</span></span><span style="display:flex;"><span>    Serial Number: 4657db8105e7b58c87e5f69ff91a84a4178
</span></span><span style="display:flex;"><span>    Domains: c3smonkey.ch *.apps.c3smonkey.ch *.c3smonkey.ch
</span></span><span style="display:flex;"><span>    Expiry Date: 2020-10-22 07:16:07+00:00 <span style="color:#f92672">(</span>VALID: <span style="color:#ae81ff">89</span> days<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Certificate Path: /etc/letsencrypt/live/c3smonkey.ch/fullchain.pem
</span></span><span style="display:flex;"><span>    Private Key Path: /etc/letsencrypt/live/c3smonkey.ch/privkey.pem
</span></span><span style="display:flex;"><span>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/alex-shpak/hugo-book/commit/a4b0a938c2eb3daee3d881291b70203bb4c13719" title='Last modified by Marcel Widmer | September 25, 2022' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>September 25, 2022</span>
    </a>
  </div>




</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#hcloud-hetzner-cli">hcloud (Hetzner CLI)</a>
      <ul>
        <li><a href="#server-type">Server Type</a></li>
        <li><a href="#image">Image</a></li>
        <li><a href="#datacenter">Datacenter</a></li>
        <li><a href="#create-server">Create Server</a>
          <ul>
            <li><a href="#rebuild-server">Rebuild Server</a></li>
            <li><a href="#delete-server">Delete Server</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#configure-dns">Configure DNS</a></li>
    <li><a href="#install-okd">Install OKD</a>
      <ul>
        <li><a href="#update-system-and-install-git">Update System and install GIT</a></li>
        <li><a href="#clone-git-repo">Clone Git Repo</a></li>
        <li><a href="#update-user-custom-exports-script">Update user-custom-exports script</a></li>
        <li><a href="#load-user-custom-exports-script">Load user-custom-exports script</a></li>
        <li><a href="#start-install-script">Start install script</a></li>
      </ul>
    </li>
    <li><a href="#renewal-lets-encrypt">Renewal Let&rsquo;s Encrypt</a>
      <ul>
        <li><a href="#check-certificate">Check Certificate</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












