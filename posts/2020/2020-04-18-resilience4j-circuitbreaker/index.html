<!DOCTYPE html>
<html lang="en-us">
<head>





<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Reactive Spring Boot with Resilience4j CircuitBreaker - Marcel&#39;s blog</title>
<meta name="description" content="This is my personal blog where I will mostly post about development.">

<meta name="author" content="">

<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6">
<link rel="alternate" href="/index.xml?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6" type="application/rss+xml" title="RSS" />
<meta property="og:title" content="Reactive Spring Boot with Resilience4j CircuitBreaker - Marcel&#39;s blog">
</meta>
<meta property="og:url" content="/posts/2020/2020-04-18-resilience4j-circuitbreaker/">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Marcel&#39;s blog">
<meta property="og:description" content="This is my personal blog where I will mostly post about development.">

<meta property="og:image" content="//images/featured_image.jpg">

<meta name="twitter:card" content="summary_large_image" /></meta>
<meta name="twitter:site" content="@"></meta>
<meta name="twitter:creator" content="@"></meta>
<meta name="twitter:title" content="Reactive Spring Boot with Resilience4j CircuitBreaker - Marcel&#39;s blog"></meta>
<meta name="twitter:url" content="/posts/2020/2020-04-18-resilience4j-circuitbreaker/"></meta>
<meta name="twitter:description" content="This is my personal blog where I will mostly post about development."></meta>

<meta property="og:image" content="//images/featured_image.jpg">


<link rel="stylesheet" href="/css/main.css?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6">
<link rel="stylesheet" href="/css/color.css?c=9a1cad0eba3bbaa81fc0397458c8f90fb88cade6">




</head>

<body >


<div id="content-header" class="title">
  
  <a class="site-title" href="/">Marcel&#39;s blog</a>
  
  <span class="site-sub-title"></span>

  

  <div id="main-menu-nav">
    <div id="main-menu-nav-items">
      
        <div class="nav-item"><a href="/tags/">Tags</a></div>
      
        <div class="nav-item"><a href="/categories/">Categories</a></div>
      
        <div class="nav-item"><a href="/posts/2022/2022-24-09-axon-mongodb-extention/">Axon Framework - MongoDB extension</a></div>
      
    </div>
  </div>
</div>
<div id="content" class="main">




<h2>Reactive Spring Boot with Resilience4j CircuitBreaker</h2>

<span class="sub">2020-04-18</span>








<h2 id="create-project">Create Project</h2>
<p>Let&rsquo;s create a Sample Application with Kotlin and Reactive Spring Boot with the <a href="https://start.spring.io/">spring inializr</a> Rest Endpoint. We will take the latest and greates Spring Boot version <code>2.3.0.M4</code> and language <code>kotlin</code> with the following dependencies:</p>
<ul>
<li>actuator</li>
<li>webflux</li>
<li>cloud-resilience4j</li>
</ul>
<pre tabindex="0"><code>http https://start.spring.io/starter.tgz \
    dependencies==actuator,webflux,cloud-resilience4j \
    description==&#34;Demo project Kotlin Spring Boot with Resilience4j&#34; \
    applicationName==Resilience4jApplication \
    name==kboot-resilience4j \
    groupId==ch.keepcalm \
    artifactId==kboot-resilience4j \
    packageName==ch.keepcalm.demo \
    javaVersion==11 \
    language==kotlin \
    baseDir==kboot-resilience4j| tar -xzvf -
</code></pre><p>Add Customer Banner</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http https://raw.githubusercontent.com/marzelwidmer/marzelwidmer.github.io/master/img/banner.txt <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    &gt; kboot-resilience4j/src/main/resources/banner.txt
</span></span></code></pre></div><p>Configure <code>spring.applicatin.name</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;spring:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  application:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    name: kboot-resilience4j&#34;</span> | &gt; kboot-resilience4j/src/main/resources/application.yaml
</span></span></code></pre></div><p>Remove <code>application.properties</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm kboot-resilience4j/src/main/resources/application.properties
</span></span></code></pre></div><p>See also my other post <a href="https://blog.marcelwidmer.org/spring-initializr/">Spring Initializr and HTTPie</a></p>
<h2 id="domain-model">Domain Model</h2>
<p>Let&rsquo;s start with the <code>Movie</code> domain class with the following properties.</p>
<ul>
<li>name</li>
<li>year</li>
<li>description</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Movie</span>(<span style="color:#66d9ef">val</span> id: String? = UUID.randomUUID().toString(), <span style="color:#66d9ef">val</span> name: String, <span style="color:#66d9ef">val</span> year: Year, <span style="color:#66d9ef">val</span> description: String)
</span></span></code></pre></div><h2 id="service">Service</h2>
<p>Now we create the service class <code>MovieService</code> who hold some hard coded movies in a list.
The amazing functions:</p>
<ul>
<li>Get all Movies</li>
<li>Get a random list of Movies</li>
<li>Get a Movie by his name</li>
<li>Get a Movie by his ID</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#a6e22e">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MovieService</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> movies = listOf(
</span></span><span style="display:flex;"><span>        Movie(name = <span style="color:#e6db74">&#34;Matrix&#34;</span>,
</span></span><span style="display:flex;"><span>            year = Year.of(<span style="color:#ae81ff">1999</span>),
</span></span><span style="display:flex;"><span>            description = <span style="color:#e6db74">&#34;A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.&#34;</span>),
</span></span><span style="display:flex;"><span>        Movie(name = <span style="color:#e6db74">&#34;The Godfather&#34;</span>,
</span></span><span style="display:flex;"><span>            year = Year.of(<span style="color:#ae81ff">1972</span>),
</span></span><span style="display:flex;"><span>            description = <span style="color:#e6db74">&#34;The aging patriarch of an organized crime dynasty transfers control of his clandestine empire to his reluctant son.&#34;</span>),
</span></span><span style="display:flex;"><span>        Movie(name = <span style="color:#e6db74">&#34;Casablanca&#34;</span>,
</span></span><span style="display:flex;"><span>            year = Year.of(<span style="color:#ae81ff">1942</span>),
</span></span><span style="display:flex;"><span>            description = <span style="color:#e6db74">&#34;A cynical American expatriate struggles to decide whether or not he should help his former lover and her fugitive husband escape French Morocco.&#34;</span>),
</span></span><span style="display:flex;"><span>        Movie(name = <span style="color:#e6db74">&#34;Rocky&#34;</span>,
</span></span><span style="display:flex;"><span>            year = Year.of(<span style="color:#ae81ff">1976</span>),
</span></span><span style="display:flex;"><span>            description = <span style="color:#e6db74">&#34;A small-time boxer gets a supremely rare chance to fight a heavy-weight champion in a bout in which he strives to go the distance for his self-respect.&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">randomMovie</span>() = Mono.just(movies[kotlin.random.Random.nextInt(movies.size)])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">movies</span>() = Flux.just(movies)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">movieById</span>(id: String) = Mono.just(movies.first { <span style="color:#66d9ef">it</span>.id <span style="color:#f92672">==</span> id })
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">movieByName</span>(name: String?): Mono&lt;Movie&gt; {
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">?.</span>map {
</span></span><span style="display:flex;"><span>                movies.firstOrNull() { <span style="color:#66d9ef">it</span>.name.toLowerCase() <span style="color:#f92672">==</span> name.toLowerCase() }<span style="color:#f92672">?.</span>let {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> Mono.just(<span style="color:#66d9ef">it</span>)
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }.isNullOrEmpty().apply {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Mono.error(IllegalArgumentException(<span style="color:#e6db74">&#34;Movie was not found.&#34;</span>))
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="rest-api">Rest API</h2>
<p>I think now is time to create a REST API <code>/movies/random</code> with the <a href="https://docs.spring.io/spring-framework/docs/current/kdoc-api/spring-framework/org.springframework.web.reactive.function.server/-router-function-dsl/index.html">Reactive router Kotlin DSL</a>.
A easy way to create a <code>WebFlux.fn</code> <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/reactive/function/server/RouterFunctions.html">RouterFunction</a>
Because we have more then one endpoint under <code>/movies</code> we use the <code>&quot;/movies&quot;.nest</code> router function.</p>
<p>We use also our service <code>MovieService</code> so we need a <a href="https://docs.spring.io/spring/docs/current/kdoc-api/spring-framework/org.springframework.context.support/-bean-definition-dsl/-bean-supplier-context/ref.html">Bean Reference</a> to it.</p>
<p><code>val service = ref&lt;MovieService&gt;()</code></p>
<blockquote>
<p>💡: Take care of the order in the Route definiton &ldquo;/&rdquo; have to be at latest position.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    runApplication&lt;Resilience4jApplication&gt;(*args) {
</span></span><span style="display:flex;"><span>        addInitializers(
</span></span><span style="display:flex;"><span>            beans {
</span></span><span style="display:flex;"><span>                bean {
</span></span><span style="display:flex;"><span>                    router {
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;movies&#34;</span>.nest {
</span></span><span style="display:flex;"><span>                             <span style="color:#66d9ef">val</span> service = ref&lt;MovieService&gt;()
</span></span><span style="display:flex;"><span>                             <span style="color:#75715e">//http :8080/movies/random
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                             GET(<span style="color:#e6db74">&#34;/random&#34;</span>) {
</span></span><span style="display:flex;"><span>                                 ok().body(service.randomMovie())
</span></span><span style="display:flex;"><span>                             }
</span></span><span style="display:flex;"><span>                             <span style="color:#75715e">//http :8080/movies/ name==&#34;Rocky&#34; -vv
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                             queryParam(<span style="color:#e6db74">&#34;name&#34;</span>, { <span style="color:#66d9ef">true</span> }) {
</span></span><span style="display:flex;"><span>                                 ok().body(service.movieByName(name = <span style="color:#66d9ef">it</span>.queryParam(<span style="color:#e6db74">&#34;name&#34;</span>).<span style="color:#66d9ef">get</span>()))
</span></span><span style="display:flex;"><span>                             }
</span></span><span style="display:flex;"><span>                             <span style="color:#75715e">//http :8080/movies/c7f399bc-ff4c-4a2f-bddf-d92d53a96df2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                             GET(<span style="color:#e6db74">&#34;/{id}&#34;</span>) {
</span></span><span style="display:flex;"><span>                                 ok().body(service.movieById(id = <span style="color:#66d9ef">it</span>.pathVariable(<span style="color:#e6db74">&#34;id&#34;</span>)))
</span></span><span style="display:flex;"><span>                             }
</span></span><span style="display:flex;"><span>                             <span style="color:#75715e">//http :8080/movies/random
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                             GET(<span style="color:#e6db74">&#34;/&#34;</span>) {
</span></span><span style="display:flex;"><span>                                 ok().body(service.movies())
</span></span><span style="display:flex;"><span>                             }
</span></span><span style="display:flex;"><span>                         }
</span></span><span style="display:flex;"><span>                     }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="test-rest-api">Test Rest API</h2>
<p>No is time to make some calls from the terminal with the <code>HTTPie</code> or in a Browser.
First start the application e.g. with <code>mvn spring-boot:run</code>.</p>
<p>Then lets call our amazing endpoints with the <code>HTTPie</code> or Browser.</p>
<h3 id="get-all-movies">Get all Movies</h3>
<p><a href="http://localhost:8080/movies">http://localhost:8080/movies</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http :8080/movies/
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>transfer-encoding: chunked
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;c7f399bc-ff4c-4a2f-bddf-d92d53a96df2&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Matrix&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1999&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;The aging patriarch of an organized crime dynasty transfers control of his clandestine empire to his reluctant son.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;0c7a74fc-b735-41a3-a383-72b9dad7d608&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;The Godfather&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1972&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A cynical American expatriate struggles to decide whether or not he should help his former lover and her fugitive husband escape French Morocco.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;15a9e15d-4a5e-4b8a-a7c5-d34b0d5d0879&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Casablanca&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1942&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A small-time boxer gets a supremely rare chance to fight a heavy-weight champion in a bout in which he strives to go the distance for his self-respect.&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;f6fb4a62-6d84-434e-8e2c-70e4c1e7ab2c&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Rocky&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1976&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="get-a-random-list-of-movies">Get a random list of Movies</h3>
<p><a href="http://localhost:8080/movies/random">http://localhost:8080/movies/random</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> http :8080/movies/random
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#ae81ff">240</span>
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A cynical American expatriate struggles to decide whether or not he should help his former lover and her fugitive husband escape French Morocco.&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;5dd310b8-8d51-4a1e-a20c-790fec00029f&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Casablanca&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1942&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="get-a-movie-by-his-name">Get a Movie by his name</h3>
<p><a href="http://localhost:8080/movies/?name=Rocky">http://localhost:8080/movies/?name=Rocky</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http :8080/movies name<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;Rocky&#34;</span> -v
</span></span><span style="display:flex;"><span>GET /movies?name<span style="color:#f92672">=</span>Rocky HTTP/1.1
</span></span><span style="display:flex;"><span>Accept: */*
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Host: localhost:8080
</span></span><span style="display:flex;"><span>User-Agent: HTTPie/2.0.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#ae81ff">242</span>
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A small-time boxer gets a supremely rare chance to fight a heavy-weight champion in a bout in which he strives to go the distance for his self-respect.&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;5cae75c6-d18a-495b-a80f-60bdd0763eb1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Rocky&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1976&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="get-a-movie-by-his-id">Get a Movie by his ID</h3>
<p><a href="http://localhost:8080/movies/5dd310b8-8d51-4a1e-a20c-790fec00029f">http://localhost:8080/movies/5dd310b8-8d51-4a1e-a20c-790fec00029f</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http :8080/movies/5dd310b8-8d51-4a1e-a20c-790fec00029f
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#ae81ff">240</span>
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;A cynical American expatriate struggles to decide whether or not he should help his former lover and her fugitive husband escape French Morocco.&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;5dd310b8-8d51-4a1e-a20c-790fec00029f&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Casablanca&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;year&#34;</span>: <span style="color:#e6db74">&#34;1942&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="search-for-a-not-existing-movie">Search for a not existing Movie</h3>
<p>Now let&rsquo;s also search for <code>http://localhost:8080/movies/?name=Creed</code> is also a great movie but this one is not yet in our <code>MovieService</code> included
we will get the following exception.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http :8080/movies name<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;Creed&#34;</span> -v
</span></span><span style="display:flex;"><span>GET /movies?name<span style="color:#f92672">=</span>Creed HTTP/1.1
</span></span><span style="display:flex;"><span>Accept: */*
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip, deflate
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Host: localhost:8080
</span></span><span style="display:flex;"><span>User-Agent: HTTPie/2.0.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">500</span> Internal Server Error
</span></span><span style="display:flex;"><span>Content-Length: <span style="color:#ae81ff">165</span>
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;Internal Server Error&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Movie was not found.&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/movies&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;requestId&#34;</span>: <span style="color:#e6db74">&#34;61569a89-3&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;status&#34;</span>: 500,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;timestamp&#34;</span>: <span style="color:#e6db74">&#34;2020-04-19T21:13:10.403+00:00&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="configure-circuitbreaker">Configure CircuitBreaker</h2>
<p>😎 Cool stuff 😎 let&rsquo;s implement the <code>CircuitBreaker</code> with <code>Resilinece4j</code>.
Let&rsquo;s configure the <code>ReactiveCircuitBreaker</code> Bean from <code>ReactiveResilience4JCircuitBreakerFactory</code> with a name <code>movie-service</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>bean {
</span></span><span style="display:flex;"><span>    ReactiveResilience4JCircuitBreakerFactory()
</span></span><span style="display:flex;"><span>        .create(<span style="color:#e6db74">&#34;movie-service&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="to-be-continued-">to be continued ..</h3>
<p>The example source code can be found here <a href="https://github.com/marzelwidmer/kboot-resilience4j">GitHub</a></p>
<blockquote>
<p>💡 <strong>Logger Configuration</strong>:
logging.pattern.console: &ldquo;%clr(%d{yyyy-MM-dd E HH:mm:ss.SSS}){blue} %clr(%-40.40logger{0}){magenta} - %clr(%m){green}%n&rdquo;</p>
</blockquote>
<hr>
<p><em>References:</em></p>
<blockquote>
<p><a href="https://resilience4j.readme.io/docs">Resilience4j docs</a></p>
</blockquote>






<hr class="block-separater">




<div class="content-footer-item">
	Tags for this post:
	
	<a class="post-tag" href="/tags/spring-boot/">Spring Boot</a>
	
</div>







<div class="content-footer-item neighbor">
	
	<div class="prev-post">Prev: <a href="/posts/2020/2020-04-12-cloud-gateway-sidecar/">Spring Cloud Gateway</a></div>
	
	
	<div class="next-post">Next: <a href="/posts/2020/2020-05-01-minikube-ingress-controller/">Kubernetes Ingress with Ngnix Ingress Controller</a></div>
	
</div>






    
    
    
    <div class="related-tag-category-list">
        <h4>Other posts tagged by "Development"</h3>
        <ul class="post-list">
          
            <li class="post-item">
  <div class="post-date sub">2022-09-24</div>
  <div class="post-title"><a href="/posts/2022/2022-24-09-axon-mongodb-extention/">Axon Framework - MongoDB extension</a></div>
  
</li>
          
            <li class="post-item">
  <div class="post-date sub">2020-10-04</div>
  <div class="post-title"><a href="/posts/2020/2020-10-04-hazelcast-k8s/">Kubernetes Hazelcast Distributed Caching</a></div>
  
</li>
          
            <li class="post-item">
  <div class="post-date sub">2020-04-18</div>
  <div class="post-title"><a href="/posts/2020/2020-04-18-resilience4j-circuitbreaker/">Reactive Spring Boot with Resilience4j CircuitBreaker</a></div>
  
</li>
          
        </ul>
        <div class="more-area">
          
          <a class="more" href='/categories/development/'>more ...</a>
          
      </div>
        </div>
    






    
    
    
    <div class="related-tag-category-list">
        <h4>Other posts tagged by "Spring Boot"</h3>
        <ul class="post-list">
          
          <li class="post-item">
  <div class="post-date sub">2020-05-04</div>
  <div class="post-title"><a href="/posts/2020/2020-05-04-camel-kotlin-spring-boot/">Apache Camel with Kotlin and Spring Boot</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2020-04-18</div>
  <div class="post-title"><a href="/posts/2020/2020-04-18-resilience4j-circuitbreaker/">Reactive Spring Boot with Resilience4j CircuitBreaker</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2020-04-16</div>
  <div class="post-title"><a href="/posts/2020/2020-04-12-cloud-gateway-sidecar/">Spring Cloud Gateway</a></div>
  
</li>
          
        </ul>
        <div class="more-area">
          
          <a class="more" href='/tags/spring-boot/'>more ...</a>
          
      </div>
        </div>
    




<script src="/js/single.js"></script>


	</div><div id="content-footer" class="sub">
  
  <div class="credit">
    Power by <a href="https://gohugo.io">Hugo</a> /
    Theme <a href="https://github.com/michimani/simplog/">simplog</a> by <a href="https://github.com/michimani/">michimani</a>
  </div>
</div></body>

</html>